
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>UFCPredictor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome-ufcpredictor-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="UFCPredictor" class="md-header__button md-logo" aria-label="UFCPredictor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UFCPredictor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="UFCPredictor" class="md-nav__button md-logo" aria-label="UFCPredictor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    UFCPredictor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-processor" class="md-nav__link">
    <span class="md-ellipsis">
      Data processor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor" class="md-nav__link">
    <span class="md-ellipsis">
      data_processor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      DataProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.aggregated_fields" class="md-nav__link">
    <span class="md-ellipsis">
      aggregated_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.normalized_fields" class="md-nav__link">
    <span class="md-ellipsis">
      normalized_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.round_stat_names" class="md-nav__link">
    <span class="md-ellipsis">
      round_stat_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.stat_names" class="md-nav__link">
    <span class="md-ellipsis">
      stat_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.add_key_stats" class="md-nav__link">
    <span class="md-ellipsis">
      add_key_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.add_per_minute_and_fight_stats" class="md-nav__link">
    <span class="md-ellipsis">
      add_per_minute_and_fight_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.aggregate_data" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.apply_filters" class="md-nav__link">
    <span class="md-ellipsis">
      apply_filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.convert_odds_to_decimal" class="md-nav__link">
    <span class="md-ellipsis">
      convert_odds_to_decimal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.fill_weight" class="md-nav__link">
    <span class="md-ellipsis">
      fill_weight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.fix_date_and_time_fields" class="md-nav__link">
    <span class="md-ellipsis">
      fix_date_and_time_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.get_fighter_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_fighter_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.get_fighter_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_fighter_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.group_round_data" class="md-nav__link">
    <span class="md-ellipsis">
      group_round_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.join_dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      join_dataframes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.normalize_data" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.OSRDataProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      OSRDataProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OSRDataProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.OSRDataProcessor.aggregate_data" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.WOSRDataProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      WOSRDataProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WOSRDataProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.WOSRDataProcessor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.WOSRDataProcessor.aggregate_data" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      datasets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset" class="md-nav__link">
    <span class="md-ellipsis">
      BasicDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BasicDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.get_fight_data_from_ids" class="md-nav__link">
    <span class="md-ellipsis">
      get_fight_data_from_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset" class="md-nav__link">
    <span class="md-ellipsis">
      ForecastDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecastDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset.get_forecast_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      get_forecast_prediction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset.get_single_forecast_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      get_single_forecast_prediction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Loss Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions" class="md-nav__link">
    <span class="md-ellipsis">
      loss_functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss" class="md-nav__link">
    <span class="md-ellipsis">
      BettingLoss
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BettingLoss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss.get_bet" class="md-nav__link">
    <span class="md-ellipsis">
      get_bet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.models" class="md-nav__link">
    <span class="md-ellipsis">
      models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.models.FighterNet" class="md-nav__link">
    <span class="md-ellipsis">
      FighterNet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FighterNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.FighterNet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.FighterNet.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.models.SymmetricFightNet" class="md-nav__link">
    <span class="md-ellipsis">
      SymmetricFightNet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SymmetricFightNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.SymmetricFightNet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.SymmetricFightNet.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.trainer" class="md-nav__link">
    <span class="md-ellipsis">
      trainer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer.test" class="md-nav__link">
    <span class="md-ellipsis">
      test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer.train" class="md-nav__link">
    <span class="md-ellipsis">
      train
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Plot tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools" class="md-nav__link">
    <span class="md-ellipsis">
      plot_tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots" class="md-nav__link">
    <span class="md-ellipsis">
      PredictionPlots
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PredictionPlots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots.plot_single_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      plot_single_prediction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots.show_fight_prediction_detail" class="md-nav__link">
    <span class="md-ellipsis">
      show_fight_prediction_detail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots.show_fight_prediction_detail_from_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      show_fight_prediction_detail_from_dataset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    <span class="md-ellipsis">
      Utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils.convert_minutes_to_seconds" class="md-nav__link">
    <span class="md-ellipsis">
      convert_minutes_to_seconds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils.convert_odds_to_decimal" class="md-nav__link">
    <span class="md-ellipsis">
      convert_odds_to_decimal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils.convert_odds_to_moneyline" class="md-nav__link">
    <span class="md-ellipsis">
      convert_odds_to_moneyline
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#data-processor" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data processor
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#datasets" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#loss-functions" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loss Functions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#models" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#trainer" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trainer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#plot-tools" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot tools
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#utils" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-processor" class="md-nav__link">
    <span class="md-ellipsis">
      Data processor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor" class="md-nav__link">
    <span class="md-ellipsis">
      data_processor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      DataProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.aggregated_fields" class="md-nav__link">
    <span class="md-ellipsis">
      aggregated_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.normalized_fields" class="md-nav__link">
    <span class="md-ellipsis">
      normalized_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.round_stat_names" class="md-nav__link">
    <span class="md-ellipsis">
      round_stat_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.stat_names" class="md-nav__link">
    <span class="md-ellipsis">
      stat_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.add_key_stats" class="md-nav__link">
    <span class="md-ellipsis">
      add_key_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.add_per_minute_and_fight_stats" class="md-nav__link">
    <span class="md-ellipsis">
      add_per_minute_and_fight_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.aggregate_data" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.apply_filters" class="md-nav__link">
    <span class="md-ellipsis">
      apply_filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.convert_odds_to_decimal" class="md-nav__link">
    <span class="md-ellipsis">
      convert_odds_to_decimal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.fill_weight" class="md-nav__link">
    <span class="md-ellipsis">
      fill_weight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.fix_date_and_time_fields" class="md-nav__link">
    <span class="md-ellipsis">
      fix_date_and_time_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.get_fighter_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_fighter_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.get_fighter_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_fighter_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.group_round_data" class="md-nav__link">
    <span class="md-ellipsis">
      group_round_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.join_dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      join_dataframes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.DataProcessor.normalize_data" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.OSRDataProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      OSRDataProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OSRDataProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.OSRDataProcessor.aggregate_data" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.WOSRDataProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      WOSRDataProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WOSRDataProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.WOSRDataProcessor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.data_processor.WOSRDataProcessor.aggregate_data" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      datasets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset" class="md-nav__link">
    <span class="md-ellipsis">
      BasicDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BasicDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.get_fight_data_from_ids" class="md-nav__link">
    <span class="md-ellipsis">
      get_fight_data_from_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.BasicDataset.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset" class="md-nav__link">
    <span class="md-ellipsis">
      ForecastDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecastDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset.get_forecast_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      get_forecast_prediction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.datasets.ForecastDataset.get_single_forecast_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      get_single_forecast_prediction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Loss Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions" class="md-nav__link">
    <span class="md-ellipsis">
      loss_functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss" class="md-nav__link">
    <span class="md-ellipsis">
      BettingLoss
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BettingLoss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.loss_functions.BettingLoss.get_bet" class="md-nav__link">
    <span class="md-ellipsis">
      get_bet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.models" class="md-nav__link">
    <span class="md-ellipsis">
      models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.models.FighterNet" class="md-nav__link">
    <span class="md-ellipsis">
      FighterNet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FighterNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.FighterNet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.FighterNet.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.models.SymmetricFightNet" class="md-nav__link">
    <span class="md-ellipsis">
      SymmetricFightNet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SymmetricFightNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.SymmetricFightNet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.models.SymmetricFightNet.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.trainer" class="md-nav__link">
    <span class="md-ellipsis">
      trainer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer.test" class="md-nav__link">
    <span class="md-ellipsis">
      test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.trainer.Trainer.train" class="md-nav__link">
    <span class="md-ellipsis">
      train
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Plot tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools" class="md-nav__link">
    <span class="md-ellipsis">
      plot_tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots" class="md-nav__link">
    <span class="md-ellipsis">
      PredictionPlots
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PredictionPlots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots.plot_single_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      plot_single_prediction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots.show_fight_prediction_detail" class="md-nav__link">
    <span class="md-ellipsis">
      show_fight_prediction_detail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ufcpredictor.plot_tools.PredictionPlots.show_fight_prediction_detail_from_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      show_fight_prediction_detail_from_dataset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    <span class="md-ellipsis">
      Utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils.convert_minutes_to_seconds" class="md-nav__link">
    <span class="md-ellipsis">
      convert_minutes_to_seconds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils.convert_odds_to_decimal" class="md-nav__link">
    <span class="md-ellipsis">
      convert_odds_to_decimal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ufcpredictor.utils.convert_odds_to_moneyline" class="md-nav__link">
    <span class="md-ellipsis">
      convert_odds_to_moneyline
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="welcome-ufcpredictor-documentation">Welcome UFCPredictor documentation</h1>
<h2 id="data-processor">Data processor</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.data_processor"></a>
    <div class="doc doc-contents first">

        <p>Data processing module for UFC fight data.</p>
<p>Provides classes to prepare and normalize data for model training and evaluation.
Handles data transformation, normalization, and feature engineering.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.data_processor.DataProcessor" class="doc doc-heading">
            <code>DataProcessor</code>


</h2>


    <div class="doc doc-contents ">


        <p>A data processor class designed to prepare and normalize UFC fight data for
training and testing neural network models.</p>
<p>This class provides a way to handle and transform raw data into a format suitable
for model training and evaluation.</p>
<p>The DataProcessor is designed to work with the dataset classes in
ufcpredictor.datasets to provide a seamless data preparation workflow.</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DataProcessor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A data processor class designed to prepare and normalize UFC fight data for</span>
<span class="sd">    training and testing neural network models.</span>

<span class="sd">    This class provides a way to handle and transform raw data into a format suitable</span>
<span class="sd">    for model training and evaluation.</span>

<span class="sd">    The DataProcessor is designed to work with the dataset classes in</span>
<span class="sd">    ufcpredictor.datasets to provide a seamless data preparation workflow.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">ufc_scraper</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UFCScraper</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bfo_scraper</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BestFightOddsScraper</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for DataProcessor.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_folder: The folder containing the data.</span>
<span class="sd">            ufc_scraper: The scraper to use for ufc data.</span>
<span class="sd">            bfo_scraper: The scraper to use for best fight odds data.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If data_folder is None and both ufc_scraper and</span>
<span class="sd">                bfo_scraper are None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data_folder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ufc_scraper</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bfo_scraper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;If data_folder is None, both ufc_scraper and bfo_scraper &quot;</span>
                <span class="s2">&quot;should be provided&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span> <span class="o">=</span> <span class="n">ufc_scraper</span> <span class="ow">or</span> <span class="n">UFCScraper</span><span class="p">(</span><span class="n">data_folder</span><span class="o">=</span><span class="n">data_folder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bfo_scraper</span> <span class="o">=</span> <span class="n">bfo_scraper</span> <span class="ow">or</span> <span class="n">BestFightOddsScraper</span><span class="p">(</span>
            <span class="n">data_folder</span><span class="o">=</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">n_sessions</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads and processes all the data.</span>

<span class="sd">        First, it joins all the relevant dataframes (fight, fighter, event, and odds).</span>
<span class="sd">        Then, it fixes the date and time fields, converts the odds to decimal format,</span>
<span class="sd">        fills the weight for each fighter (if not available), adds key statistics</span>
<span class="sd">        (KO, Submission, and Win), and applies filters to the data.</span>
<span class="sd">        Finally, it groups the round data by fighter and fight, and assigns the result</span>
<span class="sd">        to the data attribute.</span>

<span class="sd">        This method should be called before any other method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_dataframes</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fix_date_and_time_fields</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_odds_to_decimal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_weight</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_key_stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_round_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fighter_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">id_</span><span class="p">:</span> <span class="n">name_</span> <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">names</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fighter_ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">name_</span><span class="p">:</span> <span class="n">id_</span> <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">names</span><span class="p">)}</span>

    <span class="k">def</span> <span class="nf">get_fighter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name of the fighter with the given id.</span>

<span class="sd">        Args:</span>
<span class="sd">            id_: The id of the fighter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the fighter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_names</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_fighter_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the id of the fighter with the given name.</span>
<span class="sd">        Search is performed using fuzzywuzzy.</span>
<span class="sd">        If multiple matches are found, the first one is returned.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the fighter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The id of the fighter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">best_name</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">extractOne</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Fighter found for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">% accuracy: </span><span class="si">{</span><span class="n">best_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_ids</span><span class="p">[</span><span class="n">best_name</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">join_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Joins all the relevant dataframes (fight, fighter, event, and odds).</span>

<span class="sd">        It duplicates the current fight data to create two rows per match,</span>
<span class="sd">        one row for each fighter, and assigns fighter and opponent to each other.</span>
<span class="sd">        Then, it merges the fighter data, round data, and odds data to the</span>
<span class="sd">        previous table. Finally, it adds the date of the event to the dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The joined dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fight_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fight_scraper</span><span class="o">.</span><span class="n">data</span>
        <span class="n">round_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fight_scraper</span><span class="o">.</span><span class="n">rounds_handler</span><span class="o">.</span><span class="n">data</span>
        <span class="n">fighter_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fighter_scraper</span><span class="o">.</span><span class="n">data</span>
        <span class="n">event_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">event_scraper</span><span class="o">.</span><span class="n">data</span>

        <span class="n">odds_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bfo_scraper</span><span class="o">.</span><span class="n">data</span>

        <span class="c1">###########################################################</span>
        <span class="c1"># I want to create two rows per match, one row for each fighter</span>
        <span class="c1">###########################################################</span>
        <span class="c1"># Hence I need to duplicate the current fight data</span>
        <span class="c1"># Assigning fighter and opponent to each other</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">fight_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fighter_1&quot;</span><span class="p">:</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_2&quot;</span><span class="p">:</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">}</span>
                <span class="p">),</span>
                <span class="n">fight_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fighter_2&quot;</span><span class="p">:</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_1&quot;</span><span class="p">:</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">}</span>
                <span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># I am merging the fighter data to the previous table</span>
        <span class="c1"># This includes height, reach etc...</span>
        <span class="n">fighter_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_name&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_nickname&quot;</span><span class="p">]</span>
        <span class="n">fighter_data</span><span class="p">[</span><span class="s2">&quot;fighter_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">fighter_data</span><span class="p">[</span><span class="s2">&quot;fighter_f_name&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="s2">&quot; &quot;</span>
            <span class="o">+</span> <span class="n">fighter_data</span><span class="p">[</span><span class="s2">&quot;fighter_l_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">fighter_data</span><span class="p">,</span>  <span class="c1"># [fighter_fields],</span>
            <span class="n">on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">fighter_data</span><span class="p">[[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_name&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_nickname&quot;</span><span class="p">]],</span>
            <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_opponent&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1">#############################################################</span>
        <span class="c1"># Add round data.</span>
        <span class="c1">#############################################################</span>

        <span class="c1"># Merging columns</span>
        <span class="n">round_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">round_data</span><span class="p">,</span>
            <span class="n">round_data</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">],</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_opponent&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># And then remove the match of the fighter with itself</span>
        <span class="n">round_data</span> <span class="o">=</span> <span class="n">round_data</span><span class="p">[</span>
            <span class="n">round_data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">round_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_opponent&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">round_data</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;fighter_id_opponent&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

        <span class="c1">##############################################################</span>
        <span class="c1"># Add odds data</span>
        <span class="c1">###############################################################</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">odds_data</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="c1"># Add the date of the event to the dataframe</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">event_data</span><span class="p">[[</span><span class="s2">&quot;event_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">]],</span>  <span class="c1"># I only need the date for now,</span>
            <span class="n">on</span><span class="o">=</span><span class="s2">&quot;event_id&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fix_date_and_time_fields</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fix date and time fields in the dataframe.</span>

<span class="sd">        This function takes care of converting control time, finish time</span>
<span class="sd">        and total time from minutes to seconds. It also converts the</span>
<span class="sd">        event date and fighter date of birth to datetime objects.</span>

<span class="sd">        The dataframe is then sorted by fighter id and event date.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The dataframe to be processed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The dataframe with the fields fixed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_minutes_to_seconds</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time_opponent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">convert_minutes_to_seconds</span>
        <span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_minutes_to_seconds</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;total_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_round&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_time&quot;</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">])</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_dob&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_dob&quot;</span><span class="p">])</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">convert_odds_to_decimal</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert odds from American format to decimal format.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The dataframe with the odds in American format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The dataframe with the odds in decimal format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="s2">&quot;opening&quot;</span><span class="p">,</span> <span class="s2">&quot;closing_range_min&quot;</span><span class="p">,</span> <span class="s2">&quot;closing_range_max&quot;</span><span class="p">:</span>
            <span class="n">msk</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>

            <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fill_weight</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill the weight column using the weight_class column and the weight_dict.</span>

<span class="sd">        The weight_dict is a dictionary mapping the weight classes to their</span>
<span class="sd">        corresponding weights in lbs. The weights are then filled in the weight</span>
<span class="sd">        column according to the weight classes in the weight_class column.</span>

<span class="sd">        This function also removes rows with null weight classes, or open weight</span>
<span class="sd">        or catch weight (agreed weight outside a weight class).</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The dataframe to be processed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The dataframe with the weight column filled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">weight_dict</span><span class="p">)</span>

        <span class="c1">##################################################################################</span>
        <span class="c1"># Remmove null weight classes, or open weight or catch weight (agreed weight outside a weight class)</span>
        <span class="c1">##################################################################################</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span>
            <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Catch Weight&quot;</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Open Weight&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_key_stats</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add key statistics to the dataframe.</span>

<span class="sd">        This function adds columns to the dataframe indicating whether a fighter</span>
<span class="sd">        has won a fight via KO, submission or decision, and whether the opponent</span>
<span class="sd">        has won a fight via KO, submission or decision. It also adds a column</span>
<span class="sd">        indicating the age of the fighter at the time of the fight.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The dataframe to be processed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The dataframe with the added columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#############################################</span>
        <span class="c1"># Add some missing stats</span>
        <span class="c1"># KO, Submission and Win</span>
        <span class="c1">#############################################</span>
        <span class="c1"># Whether fighter has KOd his opponent</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;KO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">))</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Whether the fighter has been KOd by his opponent</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;KO_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">))</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Same for submission</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Sub&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Submission&quot;</span><span class="p">))</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Sub_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Submission&quot;</span><span class="p">))</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;win&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;win_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_dob&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span> <span class="o">/</span> <span class="mi">365</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply filters to the dataframe.</span>

<span class="sd">        This function applies filters to the dataframe to remove fights:</span>
<span class="sd">        - Before 2008, 8, 1, since I don&#39;t have odds for these</span>
<span class="sd">        - With non-standard fight formats (time_format not in [&quot;3 Rnd (5-5-5)&quot;, &quot;5 Rnd (5-5-5-5-5)&quot;])</span>
<span class="sd">        - With female fighters (gender not in [&quot;M&quot;])</span>
<span class="sd">        - With disqualified or doctor&#39;s stoppage results (result not in [&quot;Decision&quot;, &quot;KO/TKO&quot;, &quot;Submission&quot;])</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The dataframe to be processed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The dataframe with the applied filters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove old fights since I don&#39;t have odds for these</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

        <span class="c1"># Remove non-standard fight format</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time_format&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;3 Rnd (5-5-5)&quot;</span><span class="p">,</span> <span class="s2">&quot;5 Rnd (5-5-5-5-5)&quot;</span><span class="p">])]</span>

        <span class="c1"># Remove female fights</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;M&quot;</span><span class="p">]</span>

        <span class="c1"># Remove disqualified and doctor&#39;s stoppage</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;Decision&quot;</span><span class="p">,</span> <span class="s2">&quot;KO/TKO&quot;</span><span class="p">,</span> <span class="s2">&quot;Submission&quot;</span><span class="p">])]</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">round_stat_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The names of the round statistics.</span>

<span class="sd">        This property returns the names of the columns in the rounds data</span>
<span class="sd">        that are not in [&quot;fight_id&quot;, &quot;fighter_id&quot;, &quot;round&quot;]. It also returns</span>
<span class="sd">        the same names with &quot;_opponent&quot; appended, to represent the opponent&#39;s</span>
<span class="sd">        statistics.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of strings, the names of the round statistics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fight_scraper</span><span class="o">.</span><span class="n">rounds_handler</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
            <span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;_opponent&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fight_scraper</span><span class="o">.</span><span class="n">rounds_handler</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">]</span>
        <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stat_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The names of the statistics.</span>

<span class="sd">        This property returns the names of the columns in the rounds data</span>
<span class="sd">        that are not in [&quot;fight_id&quot;, &quot;fighter_id&quot;, &quot;round&quot;]. It also returns</span>
<span class="sd">        the same names with &quot;_opponent&quot; appended, to represent the opponent&#39;s</span>
<span class="sd">        statistics, and the names of the columns &quot;KO&quot;, &quot;Sub&quot; and &quot;win&quot;,</span>
<span class="sd">        which are the result of the fight, with &quot;_opponent&quot; appended to</span>
<span class="sd">        represent the opponent&#39;s result.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of strings, the names of the statistics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stat_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_stat_names</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="s2">&quot;Sub&quot;</span><span class="p">,</span> <span class="s2">&quot;win&quot;</span><span class="p">):</span>
            <span class="n">stat_names</span> <span class="o">+=</span> <span class="p">[</span><span class="n">field</span><span class="p">,</span> <span class="n">field</span> <span class="o">+</span> <span class="s2">&quot;_opponent&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">stat_names</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aggregated_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The fields that are aggregated over the fighter&#39;s history.</span>

<span class="sd">        This property returns all the statistic names, including the ones</span>
<span class="sd">        with &quot;_opponent&quot; appended to represent the opponent&#39;s statistics.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of strings, the names of the aggregated fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_names</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">normalized_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The fields that are normalized over the fighter&#39;s history.</span>

<span class="sd">        These fields are normalized in the sense that they are divided by</span>
<span class="sd">        their mean value in the history of the fighter. This is done to</span>
<span class="sd">        reduce the effect of outliers and to make the data more comparable</span>
<span class="sd">        between different fighters.</span>

<span class="sd">        The fields normalized are:</span>
<span class="sd">        - &quot;age&quot;</span>
<span class="sd">        - &quot;time_since_last_fight&quot;</span>
<span class="sd">        - &quot;fighter_height_cm&quot;</span>
<span class="sd">        - All the aggregated fields (see :meth:`aggregated_fields`),</span>
<span class="sd">          and the same fields with &quot;_per_minute&quot; and &quot;_per_fight&quot; appended,</span>
<span class="sd">          which represent the aggregated fields per minute and per fight,</span>
<span class="sd">          respectively.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of strings, the names of the normalized fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">normalized_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;time_since_last_fight&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_height_cm&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="p">:</span>
            <span class="n">normalized_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">field</span><span class="p">,</span> <span class="n">field</span> <span class="o">+</span> <span class="s2">&quot;_per_minute&quot;</span><span class="p">,</span> <span class="n">field</span> <span class="o">+</span> <span class="s2">&quot;_per_fight&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">normalized_fields</span>

    <span class="k">def</span> <span class="nf">group_round_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Group the round data by the fixed fields and sum the round statistics.</span>

<span class="sd">        The fixed fields are the columns in the data that are not in the round</span>
<span class="sd">        statistics and not in [&quot;round&quot;]. The round statistics are the columns</span>
<span class="sd">        in the data that are in the round statistics and not in [&quot;round&quot;].</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data to be grouped.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The grouped data, with the round statistics summed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fixed_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">c</span>
            <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_stat_names</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="s2">&quot;round&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
                <span class="n">fixed_fields</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>  <span class="c1"># Important to group nans as valid values.</span>
            <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">aggregate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate the data by summing the round statistics over the history of the</span>
<span class="sd">        fighters.</span>

<span class="sd">        The data is copied and then the round statistics are summed over the history</span>
<span class="sd">        of the fighters. The total time is also summed over the history of the</span>
<span class="sd">        fighters.</span>

<span class="sd">        The aggregated data is stored in the attribute data_aggregated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields to be aggregated: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">data_aggregated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">)</span>

        <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;previous_fight_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span>
            <span class="s2">&quot;event_date&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;time_since_last_fight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;previous_fight_date&quot;</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="p">:</span>
            <span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span>
                <span class="n">column</span>
            <span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

        <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;total_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span>
            <span class="s2">&quot;total_time&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span> <span class="o">=</span> <span class="n">data_aggregated</span>

    <span class="k">def</span> <span class="nf">add_per_minute_and_fight_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add two new columns to the aggregated data for each statistic.</span>

<span class="sd">        The first column is the statistic per minute, computed by dividing the</span>
<span class="sd">        statistic by the total time in the octagon. The second column is the</span>
<span class="sd">        statistic per fight, computed by dividing the statistic by the number</span>
<span class="sd">        of fights.</span>

<span class="sd">        The new columns are named &lt;statistic&gt;_per_minute and &lt;statistic&gt;_per_fight,</span>
<span class="sd">        where &lt;statistic&gt; is the name of the statistic.</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_columns</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="p">:</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;_per_minute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;total_time&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;_per_fight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_columns</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">normalize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize the aggregated data by dividing each column by its mean.</span>

<span class="sd">        This is done so that the data is more comparable between different fighters.</span>
<span class="sd">        The fields normalized are the ones in normalized_fields.</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_normalized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields to be normalized: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">normalized_fields</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_fields</span><span class="p">:</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">data_normalized</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_normalized</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">/</span> <span class="n">mean</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_normalized</span> <span class="o">=</span> <span class="n">data_normalized</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ufcpredictor.data_processor.DataProcessor.aggregated_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregated_fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The fields that are aggregated over the fighter's history.</p>
<p>This property returns all the statistic names, including the ones
with "_opponent" appended to represent the opponent's statistics.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, the names of the aggregated fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ufcpredictor.data_processor.DataProcessor.normalized_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalized_fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The fields that are normalized over the fighter's history.</p>
<p>These fields are normalized in the sense that they are divided by
their mean value in the history of the fighter. This is done to
reduce the effect of outliers and to make the data more comparable
between different fighters.</p>
<p>The fields normalized are:
- "age"
- "time_since_last_fight"
- "fighter_height_cm"
- All the aggregated fields (see :meth:<code>aggregated_fields</code>),
  and the same fields with "_per_minute" and "_per_fight" appended,
  which represent the aggregated fields per minute and per fight,
  respectively.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, the names of the normalized fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ufcpredictor.data_processor.DataProcessor.round_stat_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">round_stat_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The names of the round statistics.</p>
<p>This property returns the names of the columns in the rounds data
that are not in ["fight_id", "fighter_id", "round"]. It also returns
the same names with "_opponent" appended, to represent the opponent's
statistics.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, the names of the round statistics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ufcpredictor.data_processor.DataProcessor.stat_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stat_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The names of the statistics.</p>
<p>This property returns the names of the columns in the rounds data
that are not in ["fight_id", "fighter_id", "round"]. It also returns
the same names with "_opponent" appended, to represent the opponent's
statistics, and the names of the columns "KO", "Sub" and "win",
which are the result of the fight, with "_opponent" appended to
represent the opponent's result.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, the names of the statistics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">ufc_scraper</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bfo_scraper</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for DataProcessor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_folder</code>
            </td>
            <td>
                  <code>Optional[Path | str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The folder containing the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ufc_scraper</code>
            </td>
            <td>
                  <code>Optional[UFCScraper]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scraper to use for ufc data.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bfo_scraper</code>
            </td>
            <td>
                  <code>Optional[BestFightOddsScraper]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scraper to use for best fight odds data.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If data_folder is None and both ufc_scraper and
bfo_scraper are None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">ufc_scraper</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UFCScraper</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bfo_scraper</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BestFightOddsScraper</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for DataProcessor.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_folder: The folder containing the data.</span>
<span class="sd">        ufc_scraper: The scraper to use for ufc data.</span>
<span class="sd">        bfo_scraper: The scraper to use for best fight odds data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If data_folder is None and both ufc_scraper and</span>
<span class="sd">            bfo_scraper are None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data_folder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ufc_scraper</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bfo_scraper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;If data_folder is None, both ufc_scraper and bfo_scraper &quot;</span>
            <span class="s2">&quot;should be provided&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span> <span class="o">=</span> <span class="n">ufc_scraper</span> <span class="ow">or</span> <span class="n">UFCScraper</span><span class="p">(</span><span class="n">data_folder</span><span class="o">=</span><span class="n">data_folder</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bfo_scraper</span> <span class="o">=</span> <span class="n">bfo_scraper</span> <span class="ow">or</span> <span class="n">BestFightOddsScraper</span><span class="p">(</span>
        <span class="n">data_folder</span><span class="o">=</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">n_sessions</span><span class="o">=-</span><span class="mi">1</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.add_key_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_key_stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Add key statistics to the dataframe.</p>
<p>This function adds columns to the dataframe indicating whether a fighter
has won a fight via KO, submission or decision, and whether the opponent
has won a fight via KO, submission or decision. It also adds a column
indicating the age of the fighter at the time of the fight.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with the added columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">add_key_stats</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add key statistics to the dataframe.</span>

<span class="sd">    This function adds columns to the dataframe indicating whether a fighter</span>
<span class="sd">    has won a fight via KO, submission or decision, and whether the opponent</span>
<span class="sd">    has won a fight via KO, submission or decision. It also adds a column</span>
<span class="sd">    indicating the age of the fighter at the time of the fight.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The dataframe to be processed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dataframe with the added columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#############################################</span>
    <span class="c1"># Add some missing stats</span>
    <span class="c1"># KO, Submission and Win</span>
    <span class="c1">#############################################</span>
    <span class="c1"># Whether fighter has KOd his opponent</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;KO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">))</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Whether the fighter has been KOd by his opponent</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;KO_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">))</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Same for submission</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Sub&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Submission&quot;</span><span class="p">))</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Sub_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Submission&quot;</span><span class="p">))</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]),</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;win&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;win_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;winner&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_dob&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span> <span class="o">/</span> <span class="mi">365</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.add_per_minute_and_fight_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_per_minute_and_fight_stats</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add two new columns to the aggregated data for each statistic.</p>
<p>The first column is the statistic per minute, computed by dividing the
statistic by the total time in the octagon. The second column is the
statistic per fight, computed by dividing the statistic by the number
of fights.</p>
<p>The new columns are named <statistic>_per_minute and <statistic>_per_fight,
where <statistic> is the name of the statistic.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_per_minute_and_fight_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add two new columns to the aggregated data for each statistic.</span>

<span class="sd">    The first column is the statistic per minute, computed by dividing the</span>
<span class="sd">    statistic by the total time in the octagon. The second column is the</span>
<span class="sd">    statistic per fight, computed by dividing the statistic by the number</span>
<span class="sd">    of fights.</span>

<span class="sd">    The new columns are named &lt;statistic&gt;_per_minute and &lt;statistic&gt;_per_fight,</span>
<span class="sd">    where &lt;statistic&gt; is the name of the statistic.</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_columns</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="p">:</span>
        <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;_per_minute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;total_time&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;_per_fight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_columns</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.aggregate_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregate_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Aggregate the data by summing the round statistics over the history of the
fighters.</p>
<p>The data is copied and then the round statistics are summed over the history
of the fighters. The total time is also summed over the history of the
fighters.</p>
<p>The aggregated data is stored in the attribute data_aggregated.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Aggregate the data by summing the round statistics over the history of the</span>
<span class="sd">    fighters.</span>

<span class="sd">    The data is copied and then the round statistics are summed over the history</span>
<span class="sd">    of the fighters. The total time is also summed over the history of the</span>
<span class="sd">    fighters.</span>

<span class="sd">    The aggregated data is stored in the attribute data_aggregated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields to be aggregated: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">data_aggregated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>

    <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;previous_fight_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span>
        <span class="s2">&quot;event_date&quot;</span>
    <span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;time_since_last_fight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;previous_fight_date&quot;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_fields</span><span class="p">:</span>
        <span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span>
            <span class="n">column</span>
        <span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;total_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_aggregated</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span>
        <span class="s2">&quot;total_time&quot;</span>
    <span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span> <span class="o">=</span> <span class="n">data_aggregated</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.apply_filters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_filters</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Apply filters to the dataframe.</p>
<p>This function applies filters to the dataframe to remove fights:
- Before 2008, 8, 1, since I don't have odds for these
- With non-standard fight formats (time_format not in ["3 Rnd (5-5-5)", "5 Rnd (5-5-5-5-5)"])
- With female fighters (gender not in ["M"])
- With disqualified or doctor's stoppage results (result not in ["Decision", "KO/TKO", "Submission"])</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with the applied filters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply filters to the dataframe.</span>

<span class="sd">    This function applies filters to the dataframe to remove fights:</span>
<span class="sd">    - Before 2008, 8, 1, since I don&#39;t have odds for these</span>
<span class="sd">    - With non-standard fight formats (time_format not in [&quot;3 Rnd (5-5-5)&quot;, &quot;5 Rnd (5-5-5-5-5)&quot;])</span>
<span class="sd">    - With female fighters (gender not in [&quot;M&quot;])</span>
<span class="sd">    - With disqualified or doctor&#39;s stoppage results (result not in [&quot;Decision&quot;, &quot;KO/TKO&quot;, &quot;Submission&quot;])</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The dataframe to be processed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dataframe with the applied filters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Remove old fights since I don&#39;t have odds for these</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="c1"># Remove non-standard fight format</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time_format&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;3 Rnd (5-5-5)&quot;</span><span class="p">,</span> <span class="s2">&quot;5 Rnd (5-5-5-5-5)&quot;</span><span class="p">])]</span>

    <span class="c1"># Remove female fights</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;M&quot;</span><span class="p">]</span>

    <span class="c1"># Remove disqualified and doctor&#39;s stoppage</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;Decision&quot;</span><span class="p">,</span> <span class="s2">&quot;KO/TKO&quot;</span><span class="p">,</span> <span class="s2">&quot;Submission&quot;</span><span class="p">])]</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.convert_odds_to_decimal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_odds_to_decimal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Convert odds from American format to decimal format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with the odds in American format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with the odds in decimal format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">convert_odds_to_decimal</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert odds from American format to decimal format.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The dataframe with the odds in American format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dataframe with the odds in decimal format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="s2">&quot;opening&quot;</span><span class="p">,</span> <span class="s2">&quot;closing_range_min&quot;</span><span class="p">,</span> <span class="s2">&quot;closing_range_max&quot;</span><span class="p">:</span>
        <span class="n">msk</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>

        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.fill_weight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_weight</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Fill the weight column using the weight_class column and the weight_dict.</p>
<p>The weight_dict is a dictionary mapping the weight classes to their
corresponding weights in lbs. The weights are then filled in the weight
column according to the weight classes in the weight_class column.</p>
<p>This function also removes rows with null weight classes, or open weight
or catch weight (agreed weight outside a weight class).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with the weight column filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">fill_weight</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill the weight column using the weight_class column and the weight_dict.</span>

<span class="sd">    The weight_dict is a dictionary mapping the weight classes to their</span>
<span class="sd">    corresponding weights in lbs. The weights are then filled in the weight</span>
<span class="sd">    column according to the weight classes in the weight_class column.</span>

<span class="sd">    This function also removes rows with null weight classes, or open weight</span>
<span class="sd">    or catch weight (agreed weight outside a weight class).</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The dataframe to be processed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dataframe with the weight column filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">weight_dict</span><span class="p">)</span>

    <span class="c1">##################################################################################</span>
    <span class="c1"># Remmove null weight classes, or open weight or catch weight (agreed weight outside a weight class)</span>
    <span class="c1">##################################################################################</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Catch Weight&quot;</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight_class&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Open Weight&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.fix_date_and_time_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fix_date_and_time_fields</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Fix date and time fields in the dataframe.</p>
<p>This function takes care of converting control time, finish time
and total time from minutes to seconds. It also converts the
event date and fighter date of birth to datetime objects.</p>
<p>The dataframe is then sorted by fighter id and event date.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with the fields fixed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">fix_date_and_time_fields</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fix date and time fields in the dataframe.</span>

<span class="sd">    This function takes care of converting control time, finish time</span>
<span class="sd">    and total time from minutes to seconds. It also converts the</span>
<span class="sd">    event date and fighter date of birth to datetime objects.</span>

<span class="sd">    The dataframe is then sorted by fighter id and event date.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The dataframe to be processed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dataframe with the fields fixed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_minutes_to_seconds</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time_opponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;ctrl_time_opponent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">convert_minutes_to_seconds</span>
    <span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_minutes_to_seconds</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;total_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_round&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;finish_time&quot;</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_dob&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_dob&quot;</span><span class="p">])</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.get_fighter_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fighter_id</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the id of the fighter with the given name.
Search is performed using fuzzywuzzy.
If multiple matches are found, the first one is returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The id of the fighter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fighter_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the id of the fighter with the given name.</span>
<span class="sd">    Search is performed using fuzzywuzzy.</span>
<span class="sd">    If multiple matches are found, the first one is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the fighter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The id of the fighter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">best_name</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">extractOne</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Fighter found for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">% accuracy: </span><span class="si">{</span><span class="n">best_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_ids</span><span class="p">[</span><span class="n">best_name</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.get_fighter_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fighter_name</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the name of the fighter with the given id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>id_</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The id of the fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the fighter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fighter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the name of the fighter with the given id.</span>

<span class="sd">    Args:</span>
<span class="sd">        id_: The id of the fighter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The name of the fighter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_names</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.group_round_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_round_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Group the round data by the fixed fields and sum the round statistics.</p>
<p>The fixed fields are the columns in the data that are not in the round
statistics and not in ["round"]. The round statistics are the columns
in the data that are in the round statistics and not in ["round"].</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to be grouped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grouped data, with the round statistics summed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">group_round_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Group the round data by the fixed fields and sum the round statistics.</span>

<span class="sd">    The fixed fields are the columns in the data that are not in the round</span>
<span class="sd">    statistics and not in [&quot;round&quot;]. The round statistics are the columns</span>
<span class="sd">    in the data that are in the round statistics and not in [&quot;round&quot;].</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The data to be grouped.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The grouped data, with the round statistics summed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fixed_fields</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">c</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">c</span>
        <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_stat_names</span>
        <span class="o">+</span> <span class="p">[</span>
            <span class="s2">&quot;round&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
            <span class="n">fixed_fields</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>  <span class="c1"># Important to group nans as valid values.</span>
        <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.join_dataframes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join_dataframes</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Joins all the relevant dataframes (fight, fighter, event, and odds).</p>
<p>It duplicates the current fight data to create two rows per match,
one row for each fighter, and assigns fighter and opponent to each other.
Then, it merges the fighter data, round data, and odds data to the
previous table. Finally, it adds the date of the event to the dataframe.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The joined dataframe.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">join_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Joins all the relevant dataframes (fight, fighter, event, and odds).</span>

<span class="sd">    It duplicates the current fight data to create two rows per match,</span>
<span class="sd">    one row for each fighter, and assigns fighter and opponent to each other.</span>
<span class="sd">    Then, it merges the fighter data, round data, and odds data to the</span>
<span class="sd">    previous table. Finally, it adds the date of the event to the dataframe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The joined dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fight_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fight_scraper</span><span class="o">.</span><span class="n">data</span>
    <span class="n">round_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fight_scraper</span><span class="o">.</span><span class="n">rounds_handler</span><span class="o">.</span><span class="n">data</span>
    <span class="n">fighter_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">fighter_scraper</span><span class="o">.</span><span class="n">data</span>
    <span class="n">event_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scraper</span><span class="o">.</span><span class="n">event_scraper</span><span class="o">.</span><span class="n">data</span>

    <span class="n">odds_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bfo_scraper</span><span class="o">.</span><span class="n">data</span>

    <span class="c1">###########################################################</span>
    <span class="c1"># I want to create two rows per match, one row for each fighter</span>
    <span class="c1">###########################################################</span>
    <span class="c1"># Hence I need to duplicate the current fight data</span>
    <span class="c1"># Assigning fighter and opponent to each other</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">fight_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fighter_1&quot;</span><span class="p">:</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_2&quot;</span><span class="p">:</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">}</span>
            <span class="p">),</span>
            <span class="n">fight_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fighter_2&quot;</span><span class="p">:</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_1&quot;</span><span class="p">:</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">}</span>
            <span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># I am merging the fighter data to the previous table</span>
    <span class="c1"># This includes height, reach etc...</span>
    <span class="n">fighter_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_name&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_nickname&quot;</span><span class="p">]</span>
    <span class="n">fighter_data</span><span class="p">[</span><span class="s2">&quot;fighter_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">fighter_data</span><span class="p">[</span><span class="s2">&quot;fighter_f_name&quot;</span><span class="p">]</span>
        <span class="o">+</span> <span class="s2">&quot; &quot;</span>
        <span class="o">+</span> <span class="n">fighter_data</span><span class="p">[</span><span class="s2">&quot;fighter_l_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">fighter_data</span><span class="p">,</span>  <span class="c1"># [fighter_fields],</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">fighter_data</span><span class="p">[[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_name&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_nickname&quot;</span><span class="p">]],</span>
        <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_opponent&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1">#############################################################</span>
    <span class="c1"># Add round data.</span>
    <span class="c1">#############################################################</span>

    <span class="c1"># Merging columns</span>
    <span class="n">round_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">],</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_opponent&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># And then remove the match of the fighter with itself</span>
    <span class="n">round_data</span> <span class="o">=</span> <span class="n">round_data</span><span class="p">[</span>
        <span class="n">round_data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">round_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_opponent&quot;</span><span class="p">]</span>
    <span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fighter_id_opponent&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="c1">##############################################################</span>
    <span class="c1"># Add odds data</span>
    <span class="c1">###############################################################</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">odds_data</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fighter_id&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Add the date of the event to the dataframe</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">event_data</span><span class="p">[[</span><span class="s2">&quot;event_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">]],</span>  <span class="c1"># I only need the date for now,</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&quot;event_id&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.load_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Loads and processes all the data.</p>
<p>First, it joins all the relevant dataframes (fight, fighter, event, and odds).
Then, it fixes the date and time fields, converts the odds to decimal format,
fills the weight for each fighter (if not available), adds key statistics
(KO, Submission, and Win), and applies filters to the data.
Finally, it groups the round data by fighter and fight, and assigns the result
to the data attribute.</p>
<p>This method should be called before any other method.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads and processes all the data.</span>

<span class="sd">    First, it joins all the relevant dataframes (fight, fighter, event, and odds).</span>
<span class="sd">    Then, it fixes the date and time fields, converts the odds to decimal format,</span>
<span class="sd">    fills the weight for each fighter (if not available), adds key statistics</span>
<span class="sd">    (KO, Submission, and Win), and applies filters to the data.</span>
<span class="sd">    Finally, it groups the round data by fighter and fight, and assigns the result</span>
<span class="sd">    to the data attribute.</span>

<span class="sd">    This method should be called before any other method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_dataframes</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fix_date_and_time_fields</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_odds_to_decimal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_weight</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_key_stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_round_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fighter_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">id_</span><span class="p">:</span> <span class="n">name_</span> <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">names</span><span class="p">)}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fighter_ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">name_</span><span class="p">:</span> <span class="n">id_</span> <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">names</span><span class="p">)}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.DataProcessor.normalize_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Normalize the aggregated data by dividing each column by its mean.</p>
<p>This is done so that the data is more comparable between different fighters.
The fields normalized are the ones in normalized_fields.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalize the aggregated data by dividing each column by its mean.</span>

<span class="sd">    This is done so that the data is more comparable between different fighters.</span>
<span class="sd">    The fields normalized are the ones in normalized_fields.</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_normalized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields to be normalized: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">normalized_fields</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_fields</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">data_normalized</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_normalized</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">/</span> <span class="n">mean</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data_normalized</span> <span class="o">=</span> <span class="n">data_normalized</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.data_processor.OSRDataProcessor" class="doc doc-heading">
            <code>OSRDataProcessor</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>DataProcessor</code></p>


        <p>Extends the DataProcessor class to add OSR information.</p>
<p>The OSR shows the strength of a given fighter by showing its win/loss ratio
with contributions from their opponents win/loss ratio.</p>
<p>The OSR is computed iteratively, for each iteration the new OSR is computed
as:
    new_OSR = (old_OSR + mean_OSR_opponents + wins/n_fights)</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OSRDataProcessor</span><span class="p">(</span><span class="n">DataProcessor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extends the DataProcessor class to add OSR information.</span>

<span class="sd">    The OSR shows the strength of a given fighter by showing its win/loss ratio</span>
<span class="sd">    with contributions from their opponents win/loss ratio.</span>

<span class="sd">    The OSR is computed iteratively, for each iteration the new OSR is computed</span>
<span class="sd">    as:</span>
<span class="sd">        new_OSR = (old_OSR + mean_OSR_opponents + wins/n_fights)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">aggregate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate data by computing the fighters&#39; statistics and OSR.</span>

<span class="sd">        This method aggregates the data by computing the fighters&#39; statistics and</span>
<span class="sd">        OSR (Opponent Strength Rating). The OSR is computed as the average of the</span>
<span class="sd">        opponent&#39;s OSR and the fighter&#39;s win rate.</span>

<span class="sd">        The OSR is calculated iteratively until the difference between the new and</span>
<span class="sd">        old values is less than 0.1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">aggregate_data</span><span class="p">()</span>

        <span class="c1"># Adding OSR information</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">]</span>
        <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;win&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">new_OSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
                <span class="n">df</span><span class="p">,</span>
                <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
                <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
                <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_x&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_y&quot;</span><span class="p">])</span>
            <span class="p">]</span>

            <span class="n">OSR_opponent</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">])[</span>
                <span class="s2">&quot;OSR_y&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">df</span><span class="p">[</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;event_date&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;S&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;OSR&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;OSR_past&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">]</span>
                <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
                    <span class="n">OSR_opponent</span><span class="p">,</span>
                    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">],</span>
                    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;OSR_y&quot;</span><span class="p">:</span> <span class="s2">&quot;OSR_opp&quot;</span><span class="p">})</span>
            <span class="p">)</span>

            <span class="n">new_OSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;OSR_opp&quot;</span><span class="p">,</span> <span class="s2">&quot;OSR_past&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_OSR</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.OSRDataProcessor.aggregate_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregate_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Aggregate data by computing the fighters' statistics and OSR.</p>
<p>This method aggregates the data by computing the fighters' statistics and
OSR (Opponent Strength Rating). The OSR is computed as the average of the
opponent's OSR and the fighter's win rate.</p>
<p>The OSR is calculated iteratively until the difference between the new and
old values is less than 0.1.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Aggregate data by computing the fighters&#39; statistics and OSR.</span>

<span class="sd">    This method aggregates the data by computing the fighters&#39; statistics and</span>
<span class="sd">    OSR (Opponent Strength Rating). The OSR is computed as the average of the</span>
<span class="sd">    opponent&#39;s OSR and the fighter&#39;s win rate.</span>

<span class="sd">    The OSR is calculated iteratively until the difference between the new and</span>
<span class="sd">    old values is less than 0.1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">aggregate_data</span><span class="p">()</span>

    <span class="c1"># Adding OSR information</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;win&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">new_OSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span>
            <span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_x&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_y&quot;</span><span class="p">])</span>
        <span class="p">]</span>

        <span class="n">OSR_opponent</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">])[</span>
            <span class="s2">&quot;OSR_y&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span>
                <span class="p">[</span>
                    <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;event_date&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;S&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;OSR&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;OSR_past&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">]</span>
            <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
                <span class="n">OSR_opponent</span><span class="p">,</span>
                <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">],</span>
                <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">],</span>
                <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;OSR_y&quot;</span><span class="p">:</span> <span class="s2">&quot;OSR_opp&quot;</span><span class="p">})</span>
        <span class="p">)</span>

        <span class="n">new_OSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;OSR_opp&quot;</span><span class="p">,</span> <span class="s2">&quot;OSR_past&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_OSR</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.data_processor.WOSRDataProcessor" class="doc doc-heading">
            <code>WOSRDataProcessor</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>DataProcessor</code></p>


        <p>Extends the OSRDataProcessor class to add weights to the different components
of the OSR estimation.</p>
<p>The OSR is computed iteratively, for each iteration the new OSR is computed
as:
    new_OSR = (w1<em>old_OSR + w2</em>mean_OSR_opponents + w3*wins/n_fights)
the weights are [w1, w2, w3]</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WOSRDataProcessor</span><span class="p">(</span><span class="n">DataProcessor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extends the OSRDataProcessor class to add weights to the different components</span>
<span class="sd">    of the OSR estimation.</span>

<span class="sd">    The OSR is computed iteratively, for each iteration the new OSR is computed</span>
<span class="sd">    as:</span>
<span class="sd">        new_OSR = (w1*old_OSR + w2*mean_OSR_opponents + w3*wins/n_fights)</span>
<span class="sd">    the weights are [w1, w2, w3]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a WOSRDataProcessor object.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Any additional positional arguments to be passed to the superclass.</span>
<span class="sd">            weights : Weights for the skills, past OSR, and opponent OSR when</span>
<span class="sd">                calculating the OSR. Defaults to [0.3, 0.3, 0.3].</span>
<span class="sd">            **kwargs: Any additional keyword arguments to be passed to the superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">skills_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_OSR_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">opponent_OSR_weight</span> <span class="o">=</span> <span class="n">weights</span>

    <span class="k">def</span> <span class="nf">aggregate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate data by computing the Weighted Opponent Skill Rating (WOSR).</span>

<span class="sd">        The WOSR is calculated by taking the weighted average of the fighter&#39;s past</span>
<span class="sd">        win ratio, the fighter&#39;s past OSR, and the opponent&#39;s OSR. The weights are</span>
<span class="sd">        specified by the parameters of the constructor.</span>

<span class="sd">        The WOSR is calculated iteratively until the difference between the new and</span>
<span class="sd">        old values is less than 0.1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">aggregate_data</span><span class="p">()</span>

        <span class="c1"># Adding OSR information</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">]</span>
        <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;win&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">new_OSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
                <span class="n">df</span><span class="p">,</span>
                <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
                <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
                <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_x&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_y&quot;</span><span class="p">])</span>
            <span class="p">]</span>

            <span class="n">OSR_opponent</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">])[</span>
                <span class="s2">&quot;OSR_y&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">df</span><span class="p">[</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;event_date&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;S&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;OSR&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;OSR_past&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">]</span>
                <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
                    <span class="n">OSR_opponent</span><span class="p">,</span>
                    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">],</span>
                    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;OSR_y&quot;</span><span class="p">:</span> <span class="s2">&quot;OSR_opp&quot;</span><span class="p">})</span>
            <span class="p">)</span>

            <span class="n">new_OSR</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills_weight</span>
                <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_OSR_weight</span>
                <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_opp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">opponent_OSR_weight</span>
            <span class="p">)</span>
            <span class="n">weight_sum</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills_weight</span>
                <span class="o">+</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_OSR_weight</span>
                <span class="o">+</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_opp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">opponent_OSR_weight</span>
            <span class="p">)</span>
            <span class="n">new_OSR</span> <span class="o">/=</span> <span class="n">weight_sum</span>

            <span class="c1"># new_OSR = df[[&quot;S&quot;, &quot;OSR_opp&quot;, &quot;OSR_past&quot;]].mean(axis=1)</span>

            <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_OSR</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.WOSRDataProcessor.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize a WOSRDataProcessor object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code>Any</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any additional positional arguments to be passed to the superclass.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights for the skills, past OSR, and opponent OSR when
calculating the OSR. Defaults to [0.3, 0.3, 0.3].</p>
              </div>
            </td>
            <td>
                  <code>[0.3, 0.3, 0.3]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>Any</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any additional keyword arguments to be passed to the superclass.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a WOSRDataProcessor object.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args: Any additional positional arguments to be passed to the superclass.</span>
<span class="sd">        weights : Weights for the skills, past OSR, and opponent OSR when</span>
<span class="sd">            calculating the OSR. Defaults to [0.3, 0.3, 0.3].</span>
<span class="sd">        **kwargs: Any additional keyword arguments to be passed to the superclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">skills_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_OSR_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">opponent_OSR_weight</span> <span class="o">=</span> <span class="n">weights</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.data_processor.WOSRDataProcessor.aggregate_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregate_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Aggregate data by computing the Weighted Opponent Skill Rating (WOSR).</p>
<p>The WOSR is calculated by taking the weighted average of the fighter's past
win ratio, the fighter's past OSR, and the opponent's OSR. The weights are
specified by the parameters of the constructor.</p>
<p>The WOSR is calculated iteratively until the difference between the new and
old values is less than 0.1.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Aggregate data by computing the Weighted Opponent Skill Rating (WOSR).</span>

<span class="sd">    The WOSR is calculated by taking the weighted average of the fighter&#39;s past</span>
<span class="sd">    win ratio, the fighter&#39;s past OSR, and the opponent&#39;s OSR. The weights are</span>
<span class="sd">    specified by the parameters of the constructor.</span>

<span class="sd">    The WOSR is calculated iteratively until the difference between the new and</span>
<span class="sd">    old values is less than 0.1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">aggregate_data</span><span class="p">()</span>

    <span class="c1"># Adding OSR information</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span> <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;win&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;num_fight&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">new_OSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span>
            <span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_x&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">merged_df</span><span class="p">[</span><span class="s2">&quot;event_date_y&quot;</span><span class="p">])</span>
        <span class="p">]</span>

        <span class="n">OSR_opponent</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">])[</span>
            <span class="s2">&quot;OSR_y&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span>
                <span class="p">[</span>
                    <span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;opponent_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;event_date&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;S&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;OSR&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;OSR_past&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">]</span>
            <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
                <span class="n">OSR_opponent</span><span class="p">,</span>
                <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id&quot;</span><span class="p">],</span>
                <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">,</span> <span class="s2">&quot;fight_id_x&quot;</span><span class="p">],</span>
                <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;OSR_y&quot;</span><span class="p">:</span> <span class="s2">&quot;OSR_opp&quot;</span><span class="p">})</span>
        <span class="p">)</span>

        <span class="n">new_OSR</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills_weight</span>
            <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_OSR_weight</span>
            <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_opp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">opponent_OSR_weight</span>
        <span class="p">)</span>
        <span class="n">weight_sum</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills_weight</span>
            <span class="o">+</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_past&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_OSR_weight</span>
            <span class="o">+</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR_opp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">opponent_OSR_weight</span>
        <span class="p">)</span>
        <span class="n">new_OSR</span> <span class="o">/=</span> <span class="n">weight_sum</span>

        <span class="c1"># new_OSR = df[[&quot;S&quot;, &quot;OSR_opp&quot;, &quot;OSR_past&quot;]].mean(axis=1)</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_OSR</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data_aggregated</span><span class="p">[</span><span class="s2">&quot;OSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_OSR</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="datasets">Datasets</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.datasets"></a>
    <div class="doc doc-contents first">

        <p>This module contains dataset classes designed to handle UFC fight data for training 
and testing neural network models.</p>
<p>The dataset classes provide a structured way to store and retrieve data for fighter 
characteristics, fight outcomes, and odds. They are designed to work with the 
DataProcessor class to prepare and normalize the data.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.datasets.BasicDataset" class="doc doc-heading">
            <code>BasicDataset</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Dataset</code></p>


        <p>A basic dataset class designed to handle UFC fight data for training and testing
neural network models.</p>
<p>This class provides a simple way to store and retrieve data for fighter
characteristics, fight outcomes, and odds. It is designed to be used with the
SymmetricFightNet model and other UFC prediction models.</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BasicDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A basic dataset class designed to handle UFC fight data for training and testing</span>
<span class="sd">    neural network models.</span>

<span class="sd">    This class provides a simple way to store and retrieve data for fighter</span>
<span class="sd">    characteristics, fight outcomes, and odds. It is designed to be used with the</span>
<span class="sd">    SymmetricFightNet model and other UFC prediction models.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">X_set</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;knockdowns_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;head_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;head_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;leg_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;leg_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;distance_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;distance_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ground_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ground_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clinch_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clinch_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_strikes_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_strikes_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;takedown_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;takedown_succ_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;submission_att_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reversals_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ctrl_time_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KO_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sub_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KO_per_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sub_per_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time_since_last_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;win_per_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;age&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fighter_height_cm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;knockdowns_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;head_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;head_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;leg_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;leg_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;distance_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;distance_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ground_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ground_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clinch_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clinch_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_strikes_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_strikes_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;takedown_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;takedown_succ_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;submission_att_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reversals_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ctrl_time_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KO_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sub_opponent_per_minute&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KO_opponent_per_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sub_opponent_per_fight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;win_opponent_per_fight&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data_processor</span><span class="p">:</span> <span class="n">DataProcessor</span><span class="p">,</span>
        <span class="n">fight_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">X_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for ForecastDataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_processor: The DataProcessor instance that contains the data.</span>
<span class="sd">            fight_ids: The list of fight ids to include in the dataset.</span>
<span class="sd">            X_set: The list of columns to include in the dataset. If None, use all</span>
<span class="sd">            columns.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If some columns are not found in the normalized data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span> <span class="o">=</span> <span class="n">data_processor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fight_ids</span> <span class="o">=</span> <span class="n">fight_ids</span>

        <span class="k">if</span> <span class="n">X_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span> <span class="o">=</span> <span class="n">X_set</span>

        <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns not found in normalized data: </span><span class="si">{</span><span class="n">not_found</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the data into a format that can be used to train a model.</span>

<span class="sd">        The data is first reduced to only include the columns specified in X_set.</span>
<span class="sd">        Then, the stats are shifted to get the stats prior to each fight.</span>
<span class="sd">        The data is then merged with itself to get one row per match with the data</span>
<span class="sd">        from the two fighters.</span>
<span class="sd">        The matchings of the fighter with itself are removed and only one row per</span>
<span class="sd">        match is kept.</span>
<span class="sd">        Finally, the data is loaded into torch tensors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reduced_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># We shift stats because the input for the model should be the</span>
        <span class="c1"># stats prior to the fight</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">:</span>
            <span class="n">reduced_data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">reduced_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># We remove invalid fights</span>
        <span class="n">reduced_data</span> <span class="o">=</span> <span class="n">reduced_data</span><span class="p">[</span><span class="n">reduced_data</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fight_ids</span><span class="p">)]</span>

        <span class="c1"># We now merge stats with itself to get one row per match with the data</span>
        <span class="c1"># from the two fighters</span>
        <span class="n">fight_data</span> <span class="o">=</span> <span class="n">reduced_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">reduced_data</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Remove matchings of the fighter with itself and also only keep</span>
        <span class="c1"># one row per match (fighter1 vs fighter2 is the same as fighter 2 vs fighter 1)</span>
        <span class="n">fight_data</span> <span class="o">=</span> <span class="n">fight_data</span><span class="p">[</span>
            <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_y&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">fight_data</span> <span class="o">=</span> <span class="n">fight_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>

        <span class="c1"># Now we load the data into torch tensors</span>
        <span class="c1"># This is a list of FloatTensors each having a size equal to the number</span>
        <span class="c1"># of fights.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;winner_x&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
            <span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span> <span class="o">=</span> <span class="n">fight_data</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the size of the dataset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The size of the dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a tuple of (X, Y, winner, odds_1, odds_2) for the given index.</span>

<span class="sd">        The data is randomly flipped to simulate the possibility of a fight being</span>
<span class="sd">        between two fighters in either order.</span>

<span class="sd">        Args:</span>
<span class="sd">            idx: The index of the data to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of (X, Y, winner, odds_1, odds_2) where X and Y are the</span>
<span class="sd">            input data for the two fighters, winner is a tensor of size 1</span>
<span class="sd">            indicating which fighter won, and odds_1 and odds_2 are the opening</span>
<span class="sd">            odds for the two fighters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">winner</span><span class="p">,</span> <span class="n">odds_1</span><span class="p">,</span> <span class="n">odds_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span>
            <span class="n">winner</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">winner</span>
            <span class="n">odds_1</span><span class="p">,</span> <span class="n">odds_2</span> <span class="o">=</span> <span class="n">odds_2</span><span class="p">,</span> <span class="n">odds_1</span>

        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">winner</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">odds_1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">odds_2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_fight_data_from_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fight_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
    <span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a tuple of (X, Y, winner, odds_1, odds_2, fighter_names, opponent_names)</span>
<span class="sd">        for the given fight ids.</span>

<span class="sd">        If fight_ids is None, returns all the data in the dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            fight_ids: The list of fight ids to include in the dataset. If None,</span>
<span class="sd">                use all the data in the dataset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of (X, Y, winner, odds_1, odds_2, fighter_names, opponent_names)</span>
<span class="sd">            where X and Y are the input data for the two fighters, winner is a tensor</span>
<span class="sd">            of size 1 indicating which fighter won, and odds_1 and odds_2 are the</span>
<span class="sd">            opening odds for the two fighters. fighter_names and opponent_names are</span>
<span class="sd">            the names of the fighters and their opponents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fight_ids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fight_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">fight_ids</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fight_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;winner_x&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
            <span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">fighter_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_name_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">opponent_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_name_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">return</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.BasicDataset.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a tuple of (X, Y, winner, odds_1, odds_2) for the given index.</p>
<p>The data is randomly flipped to simulate the possibility of a fight being
between two fighters in either order.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the data to return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of (X, Y, winner, odds_1, odds_2) where X and Y are the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input data for the two fighters, winner is a tensor of size 1</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indicating which fighter won, and odds_1 and odds_2 are the opening</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>odds for the two fighters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of (X, Y, winner, odds_1, odds_2) for the given index.</span>

<span class="sd">    The data is randomly flipped to simulate the possibility of a fight being</span>
<span class="sd">    between two fighters in either order.</span>

<span class="sd">    Args:</span>
<span class="sd">        idx: The index of the data to return.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of (X, Y, winner, odds_1, odds_2) where X and Y are the</span>
<span class="sd">        input data for the two fighters, winner is a tensor of size 1</span>
<span class="sd">        indicating which fighter won, and odds_1 and odds_2 are the opening</span>
<span class="sd">        odds for the two fighters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">winner</span><span class="p">,</span> <span class="n">odds_1</span><span class="p">,</span> <span class="n">odds_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span>
        <span class="n">winner</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">winner</span>
        <span class="n">odds_1</span><span class="p">,</span> <span class="n">odds_2</span> <span class="o">=</span> <span class="n">odds_2</span><span class="p">,</span> <span class="n">odds_1</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">winner</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">odds_1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">odds_2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.BasicDataset.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data_processor</span><span class="p">,</span> <span class="n">fight_ids</span><span class="p">,</span> <span class="n">X_set</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for ForecastDataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_processor</code>
            </td>
            <td>
                  <code>DataProcessor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataProcessor instance that contains the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fight_ids</code>
            </td>
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of fight ids to include in the dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_set</code>
            </td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of columns to include in the dataset. If None, use all</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If some columns are not found in the normalized data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data_processor</span><span class="p">:</span> <span class="n">DataProcessor</span><span class="p">,</span>
    <span class="n">fight_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">X_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for ForecastDataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_processor: The DataProcessor instance that contains the data.</span>
<span class="sd">        fight_ids: The list of fight ids to include in the dataset.</span>
<span class="sd">        X_set: The list of columns to include in the dataset. If None, use all</span>
<span class="sd">        columns.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If some columns are not found in the normalized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span> <span class="o">=</span> <span class="n">data_processor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fight_ids</span> <span class="o">=</span> <span class="n">fight_ids</span>

    <span class="k">if</span> <span class="n">X_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span> <span class="o">=</span> <span class="n">X_set</span>

    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns not found in normalized data: </span><span class="si">{</span><span class="n">not_found</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.BasicDataset.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the size of the dataset.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the size of the dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The size of the dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.BasicDataset.get_fight_data_from_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fight_data_from_ids</span><span class="p">(</span><span class="n">fight_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a tuple of (X, Y, winner, odds_1, odds_2, fighter_names, opponent_names)
for the given fight ids.</p>
<p>If fight_ids is None, returns all the data in the dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fight_ids</code>
            </td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of fight ids to include in the dataset. If None,
use all the data in the dataset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>FloatTensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of (X, Y, winner, odds_1, odds_2, fighter_names, opponent_names)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>FloatTensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>where X and Y are the input data for the two fighters, winner is a tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>FloatTensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of size 1 indicating which fighter won, and odds_1 and odds_2 are the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>FloatTensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>opening odds for the two fighters. fighter_names and opponent_names are</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>FloatTensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the names of the fighters and their opponents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fight_data_from_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fight_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">,</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of (X, Y, winner, odds_1, odds_2, fighter_names, opponent_names)</span>
<span class="sd">    for the given fight ids.</span>

<span class="sd">    If fight_ids is None, returns all the data in the dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        fight_ids: The list of fight ids to include in the dataset. If None,</span>
<span class="sd">            use all the data in the dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of (X, Y, winner, odds_1, odds_2, fighter_names, opponent_names)</span>
<span class="sd">        where X and Y are the input data for the two fighters, winner is a tensor</span>
<span class="sd">        of size 1 indicating which fighter won, and odds_1 and odds_2 are the</span>
<span class="sd">        opening odds for the two fighters. fighter_names and opponent_names are</span>
<span class="sd">        the names of the fighters and their opponents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fight_ids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fight_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">fight_ids</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fight_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;winner_x&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
        <span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">fighter_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_name_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">opponent_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_name_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">return</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.BasicDataset.load_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Loads the data into a format that can be used to train a model.</p>
<p>The data is first reduced to only include the columns specified in X_set.
Then, the stats are shifted to get the stats prior to each fight.
The data is then merged with itself to get one row per match with the data
from the two fighters.
The matchings of the fighter with itself are removed and only one row per
match is kept.
Finally, the data is loaded into torch tensors.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the data into a format that can be used to train a model.</span>

<span class="sd">    The data is first reduced to only include the columns specified in X_set.</span>
<span class="sd">    Then, the stats are shifted to get the stats prior to each fight.</span>
<span class="sd">    The data is then merged with itself to get one row per match with the data</span>
<span class="sd">    from the two fighters.</span>
<span class="sd">    The matchings of the fighter with itself are removed and only one row per</span>
<span class="sd">    match is kept.</span>
<span class="sd">    Finally, the data is loaded into torch tensors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reduced_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># We shift stats because the input for the model should be the</span>
    <span class="c1"># stats prior to the fight</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">:</span>
        <span class="n">reduced_data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">reduced_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">)[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># We remove invalid fights</span>
    <span class="n">reduced_data</span> <span class="o">=</span> <span class="n">reduced_data</span><span class="p">[</span><span class="n">reduced_data</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fight_ids</span><span class="p">)]</span>

    <span class="c1"># We now merge stats with itself to get one row per match with the data</span>
    <span class="c1"># from the two fighters</span>
    <span class="n">fight_data</span> <span class="o">=</span> <span class="n">reduced_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">reduced_data</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;fight_id&quot;</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Remove matchings of the fighter with itself and also only keep</span>
    <span class="c1"># one row per match (fighter1 vs fighter2 is the same as fighter 2 vs fighter 1)</span>
    <span class="n">fight_data</span> <span class="o">=</span> <span class="n">fight_data</span><span class="p">[</span>
        <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_y&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">fight_data</span> <span class="o">=</span> <span class="n">fight_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fight_id&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>

    <span class="c1"># Now we load the data into torch tensors</span>
    <span class="c1"># This is a list of FloatTensors each having a size equal to the number</span>
    <span class="c1"># of fights.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">fight_data</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;winner_x&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;fighter_id_x&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
        <span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">fight_data</span><span class="p">[</span><span class="s2">&quot;opening_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fight_data</span> <span class="o">=</span> <span class="n">fight_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.datasets.ForecastDataset" class="doc doc-heading">
            <code>ForecastDataset</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Dataset</code></p>


        <p>A dataset class designed to handle forecasting data for UFC fight predictions.</p>
<p>This class provides a structured way to store and retrieve data for training and
testing neural network models. It is designed to work with the DataProcessor class
to prepare and normalize the data.</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ForecastDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dataset class designed to handle forecasting data for UFC fight predictions.</span>

<span class="sd">    This class provides a structured way to store and retrieve data for training and</span>
<span class="sd">    testing neural network models. It is designed to work with the DataProcessor class</span>
<span class="sd">    to prepare and normalize the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">X_set</span> <span class="o">=</span> <span class="n">BasicDataset</span><span class="o">.</span><span class="n">X_set</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data_processor</span><span class="p">:</span> <span class="n">DataProcessor</span><span class="p">,</span>
        <span class="n">X_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for ForecastDataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_processor: The DataProcessor instance that contains the data.</span>
<span class="sd">            X_set: The list of columns to include in the dataset. If None, use all</span>
<span class="sd">                columns.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If some columns are not found in the normalized data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span> <span class="o">=</span> <span class="n">data_processor</span>

        <span class="k">if</span> <span class="n">X_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span> <span class="o">=</span> <span class="n">X_set</span>

        <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns not found in normalized data: </span><span class="si">{</span><span class="n">not_found</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_single_forecast_prediction</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">fighter_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">opponent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">event_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
            <span class="n">odds1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">odds2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
            <span class="n">parse_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a prediction for a single match. Either providing the names of the</span>
<span class="sd">        fighters and their opponents, or providing the ids of the fighters and</span>
<span class="sd">        their opponents.</span>

<span class="sd">        Args:</span>
<span class="sd">            fighter_name: The name of the fighter.</span>
<span class="sd">            opponent_name: The name of the opponent.</span>
<span class="sd">            event_date: The date of the fight.</span>
<span class="sd">            odds1: The odds of the first fighter.</span>
<span class="sd">            odds2: The odds of the second fighter.</span>
<span class="sd">            model: The model to make the prediction with.</span>
<span class="sd">            parse_ids: Whether to parse the ids of the fighters and opponents. Ids</span>
<span class="sd">                are parsed in fields &quot;fighter_name&quot; and &quot;opponent_name&quot;if True,</span>
<span class="sd">                and names are parsed if False.</span>

<span class="sd">        Returns: The predicted odds for the first and second fighters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_forecast_prediction</span><span class="p">(</span>
            <span class="p">[</span>
               <span class="n">fighter_name</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">opponent_name</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">event_date</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">odds1</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">odds2</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">parse_ids</span><span class="o">=</span><span class="n">parse_ids</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_forecast_prediction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fighter_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">opponent_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">event_dates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">],</span>
        <span class="n">fighter_odds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">opponent_odds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">parse_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a prediction for a given list of matches. Either providing the names of</span>
<span class="sd">        the fighters and their opponents, or providing the ids of the fighters and</span>
<span class="sd">        their opponents.</span>

<span class="sd">        Args:</span>
<span class="sd">            fighters_names: The list of fighters names.</span>
<span class="sd">            opponent_names: The list of opponent names.</span>
<span class="sd">            event_dates: The list of event dates.</span>
<span class="sd">            fighter_odds: The list of fighter odds.</span>
<span class="sd">            opponent_odds: The list of opponent odds.</span>
<span class="sd">            model: The model to make the prediction with.</span>
<span class="sd">            parse_ids: Whether to parse the ids of the fighters and opponents. Ids</span>
<span class="sd">                are parsed in fields &quot;fighter_names&quot; and &quot;opponent_names&quot;if True,</span>
<span class="sd">                and names are parsed if False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of two numpy arrays, each containing the predictions for one of the</span>
<span class="sd">            fighters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parse_ids</span><span class="p">:</span>
            <span class="n">fighter_ids</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">get_fighter_id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fighter_names</span><span class="p">]</span>
            <span class="n">opponent_ids</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">get_fighter_id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">opponent_names</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fighter_ids</span> <span class="o">=</span> <span class="n">fighter_names</span>
            <span class="n">opponent_ids</span> <span class="o">=</span> <span class="n">opponent_names</span>

        <span class="n">match_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;fighter_id&quot;</span><span class="p">:</span> <span class="n">fighter_ids</span> <span class="o">+</span> <span class="n">opponent_ids</span><span class="p">,</span>
                <span class="s2">&quot;event_date_forecast&quot;</span><span class="p">:</span> <span class="n">event_dates</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;opening&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">fighter_odds</span><span class="p">,</span> <span class="n">opponent_odds</span><span class="p">)),</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="p">[</span>
            <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;event_date_forecast&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
            <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date_forecast&quot;</span><span class="p">],</span>
            <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;id_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
            <span class="o">+</span> <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;event_date_forecast&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># This data dict is used to facilitate the construction of the tensors</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">id_</span><span class="p">:</span> <span class="n">data</span>
            <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;id_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">match_data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="n">fighter_id</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event_date</span><span class="p">)]</span>
                        <span class="k">for</span> <span class="n">fighter_id</span><span class="p">,</span> <span class="n">event_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fighter_ids</span><span class="p">,</span> <span class="n">event_dates</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">),</span>  <span class="c1"># X1</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="n">fighter_id</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event_date</span><span class="p">)]</span>
                        <span class="k">for</span> <span class="n">fighter_id</span><span class="p">,</span> <span class="n">event_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">opponent_ids</span><span class="p">,</span> <span class="n">event_dates</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">),</span>  <span class="c1"># X2</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fighter_odds</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># Odds1,</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">opponent_odds</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># Odds2</span>
        <span class="p">]</span>

        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">predictions_1</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="n">predictions_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">predictions_1</span><span class="p">,</span> <span class="n">predictions_2</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.ForecastDataset.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data_processor</span><span class="p">,</span> <span class="n">X_set</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for ForecastDataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_processor</code>
            </td>
            <td>
                  <code>DataProcessor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataProcessor instance that contains the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_set</code>
            </td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of columns to include in the dataset. If None, use all
columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If some columns are not found in the normalized data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data_processor</span><span class="p">:</span> <span class="n">DataProcessor</span><span class="p">,</span>
    <span class="n">X_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for ForecastDataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_processor: The DataProcessor instance that contains the data.</span>
<span class="sd">        X_set: The list of columns to include in the dataset. If None, use all</span>
<span class="sd">            columns.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If some columns are not found in the normalized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span> <span class="o">=</span> <span class="n">data_processor</span>

    <span class="k">if</span> <span class="n">X_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span> <span class="o">=</span> <span class="n">X_set</span>

    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns not found in normalized data: </span><span class="si">{</span><span class="n">not_found</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.ForecastDataset.get_forecast_prediction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_forecast_prediction</span><span class="p">(</span><span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span><span class="p">,</span> <span class="n">event_dates</span><span class="p">,</span> <span class="n">fighter_odds</span><span class="p">,</span> <span class="n">opponent_odds</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">parse_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Make a prediction for a given list of matches. Either providing the names of
the fighters and their opponents, or providing the ids of the fighters and
their opponents.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fighters_names</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of fighters names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opponent_names</code>
            </td>
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of opponent names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_dates</code>
            </td>
            <td>
                  <code>List[str | date]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of event dates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fighter_odds</code>
            </td>
            <td>
                  <code>List[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of fighter odds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opponent_odds</code>
            </td>
            <td>
                  <code>List[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of opponent odds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to make the prediction with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parse_ids</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to parse the ids of the fighters and opponents. Ids
are parsed in fields "fighter_names" and "opponent_names"if True,
and names are parsed if False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NDArray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of two numpy arrays, each containing the predictions for one of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>NDArray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fighters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_forecast_prediction</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fighter_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">opponent_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">event_dates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">],</span>
    <span class="n">fighter_odds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">opponent_odds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">parse_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a prediction for a given list of matches. Either providing the names of</span>
<span class="sd">    the fighters and their opponents, or providing the ids of the fighters and</span>
<span class="sd">    their opponents.</span>

<span class="sd">    Args:</span>
<span class="sd">        fighters_names: The list of fighters names.</span>
<span class="sd">        opponent_names: The list of opponent names.</span>
<span class="sd">        event_dates: The list of event dates.</span>
<span class="sd">        fighter_odds: The list of fighter odds.</span>
<span class="sd">        opponent_odds: The list of opponent odds.</span>
<span class="sd">        model: The model to make the prediction with.</span>
<span class="sd">        parse_ids: Whether to parse the ids of the fighters and opponents. Ids</span>
<span class="sd">            are parsed in fields &quot;fighter_names&quot; and &quot;opponent_names&quot;if True,</span>
<span class="sd">            and names are parsed if False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of two numpy arrays, each containing the predictions for one of the</span>
<span class="sd">        fighters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">parse_ids</span><span class="p">:</span>
        <span class="n">fighter_ids</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">get_fighter_id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fighter_names</span><span class="p">]</span>
        <span class="n">opponent_ids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">get_fighter_id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">opponent_names</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fighter_ids</span> <span class="o">=</span> <span class="n">fighter_names</span>
        <span class="n">opponent_ids</span> <span class="o">=</span> <span class="n">opponent_names</span>

    <span class="n">match_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;fighter_id&quot;</span><span class="p">:</span> <span class="n">fighter_ids</span> <span class="o">+</span> <span class="n">opponent_ids</span><span class="p">,</span>
            <span class="s2">&quot;event_date_forecast&quot;</span><span class="p">:</span> <span class="n">event_dates</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;opening&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">fighter_odds</span><span class="p">,</span> <span class="n">opponent_odds</span><span class="p">)),</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">data_normalized</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="p">[</span>
        <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;event_date&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;event_date_forecast&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
        <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date&quot;</span><span class="p">],</span>
        <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">match_data</span> <span class="o">=</span> <span class="n">match_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
        <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;event_date_forecast&quot;</span><span class="p">],</span>
        <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;id_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;fighter_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
        <span class="o">+</span> <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;event_date_forecast&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># This data dict is used to facilitate the construction of the tensors</span>
    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">id_</span><span class="p">:</span> <span class="n">data</span>
        <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">match_data</span><span class="p">[</span><span class="s2">&quot;id_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">match_data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_set</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="n">fighter_id</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event_date</span><span class="p">)]</span>
                    <span class="k">for</span> <span class="n">fighter_id</span><span class="p">,</span> <span class="n">event_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fighter_ids</span><span class="p">,</span> <span class="n">event_dates</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>  <span class="c1"># X1</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="n">fighter_id</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event_date</span><span class="p">)]</span>
                    <span class="k">for</span> <span class="n">fighter_id</span><span class="p">,</span> <span class="n">event_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">opponent_ids</span><span class="p">,</span> <span class="n">event_dates</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>  <span class="c1"># X2</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fighter_odds</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># Odds1,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">opponent_odds</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># Odds2</span>
    <span class="p">]</span>

    <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">predictions_1</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">predictions_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">predictions_1</span><span class="p">,</span> <span class="n">predictions_2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.datasets.ForecastDataset.get_single_forecast_prediction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_single_forecast_prediction</span><span class="p">(</span><span class="n">fighter_name</span><span class="p">,</span> <span class="n">opponent_name</span><span class="p">,</span> <span class="n">event_date</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">parse_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Make a prediction for a single match. Either providing the names of the
fighters and their opponents, or providing the ids of the fighters and
their opponents.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fighter_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opponent_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the opponent.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_date</code>
            </td>
            <td>
                  <code>str | date</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The date of the fight.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds1</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The odds of the first fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds2</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The odds of the second fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to make the prediction with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parse_ids</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to parse the ids of the fighters and opponents. Ids
are parsed in fields "fighter_name" and "opponent_name"if True,
and names are parsed if False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns: The predicted odds for the first and second fighters.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/datasets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_single_forecast_prediction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fighter_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">opponent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">event_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
        <span class="n">odds1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">odds2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">parse_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a prediction for a single match. Either providing the names of the</span>
<span class="sd">    fighters and their opponents, or providing the ids of the fighters and</span>
<span class="sd">    their opponents.</span>

<span class="sd">    Args:</span>
<span class="sd">        fighter_name: The name of the fighter.</span>
<span class="sd">        opponent_name: The name of the opponent.</span>
<span class="sd">        event_date: The date of the fight.</span>
<span class="sd">        odds1: The odds of the first fighter.</span>
<span class="sd">        odds2: The odds of the second fighter.</span>
<span class="sd">        model: The model to make the prediction with.</span>
<span class="sd">        parse_ids: Whether to parse the ids of the fighters and opponents. Ids</span>
<span class="sd">            are parsed in fields &quot;fighter_name&quot; and &quot;opponent_name&quot;if True,</span>
<span class="sd">            and names are parsed if False.</span>

<span class="sd">    Returns: The predicted odds for the first and second fighters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_forecast_prediction</span><span class="p">(</span>
        <span class="p">[</span>
           <span class="n">fighter_name</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="p">[</span>
            <span class="n">opponent_name</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="p">[</span>
            <span class="n">event_date</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="p">[</span>
            <span class="n">odds1</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="p">[</span>
            <span class="n">odds2</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">parse_ids</span><span class="o">=</span><span class="n">parse_ids</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="loss-functions">Loss Functions</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.loss_functions"></a>
    <div class="doc doc-contents first">

        <p>This module contains loss functions designed to train neural network models to predict 
the outcome of UFC fights.</p>
<p>The loss functions take into account the predictions made by the model and the actual 
outcomes of the fights, and are used to optimize the model's performance.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.loss_functions.BettingLoss" class="doc doc-heading">
            <code>BettingLoss</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>







              <details class="quote">
                <summary>Source code in <code>ufcpredictor/loss_functions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BettingLoss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the BettingLoss instance.</span>

<span class="sd">        This function calls the constructor of the parent class and performs no</span>
<span class="sd">        other actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BettingLoss</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_bet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the bet for the given prediction.</span>

<span class="sd">        This function takes a prediction between 0 and 1 and returns the</span>
<span class="sd">        corresponding bet between 0 and 20. The bet is computed as the</span>
<span class="sd">        prediction times 2 times 10. This is just an approximation</span>
<span class="sd">        that seems to work well.</span>

<span class="sd">        Args:</span>
<span class="sd">            prediction: A tensor or float between 0 and 1 representing a</span>
<span class="sd">                prediction.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tensor or float between 0 and 20 representing the bet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">prediction</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">predictions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">targets</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">odds_1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">odds_2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the betting loss for the given predictions and targets.</span>

<span class="sd">        This function takes a tensor of predictions between 0 and 1, a tensor of</span>
<span class="sd">        targets (0 or 1), and two tensors of odds. It returns a tensor with the</span>
<span class="sd">        computed betting loss, which is the mean of the losses minus the earnings,</span>
<span class="sd">        this is the net profit.</span>

<span class="sd">        The betting loss returned is the negative profit.</span>

<span class="sd">        Args:</span>
<span class="sd">            predictions: A tensor of predictions between 0 and 1.</span>
<span class="sd">            targets: A tensor of targets (0 or 1).</span>
<span class="sd">            odds_1: A tensor of odds for fighter 1.</span>
<span class="sd">            odds_2: A tensor of odds for fighter 2.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tensor with the computed betting loss.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msk</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="n">targets</span>

        <span class="n">return_fighter_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">*</span> <span class="n">odds_1</span>
        <span class="n">return_fighter_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">odds_2</span>

        <span class="n">losses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">earnings</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
        <span class="n">earnings</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">return_fighter_1</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">earnings</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">return_fighter_2</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">losses</span> <span class="o">-</span> <span class="n">earnings</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.loss_functions.BettingLoss.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the BettingLoss instance.</p>
<p>This function calls the constructor of the parent class and performs no
other actions.</p>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/loss_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the BettingLoss instance.</span>

<span class="sd">    This function calls the constructor of the parent class and performs no</span>
<span class="sd">    other actions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">BettingLoss</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.loss_functions.BettingLoss.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">odds_1</span><span class="p">,</span> <span class="n">odds_2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes the betting loss for the given predictions and targets.</p>
<p>This function takes a tensor of predictions between 0 and 1, a tensor of
targets (0 or 1), and two tensors of odds. It returns a tensor with the
computed betting loss, which is the mean of the losses minus the earnings,
this is the net profit.</p>
<p>The betting loss returned is the negative profit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictions</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor of predictions between 0 and 1.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>targets</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor of targets (0 or 1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds_1</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor of odds for fighter 1.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds_2</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor of odds for fighter 2.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with the computed betting loss.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/loss_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">predictions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">targets</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">odds_1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">odds_2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the betting loss for the given predictions and targets.</span>

<span class="sd">    This function takes a tensor of predictions between 0 and 1, a tensor of</span>
<span class="sd">    targets (0 or 1), and two tensors of odds. It returns a tensor with the</span>
<span class="sd">    computed betting loss, which is the mean of the losses minus the earnings,</span>
<span class="sd">    this is the net profit.</span>

<span class="sd">    The betting loss returned is the negative profit.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictions: A tensor of predictions between 0 and 1.</span>
<span class="sd">        targets: A tensor of targets (0 or 1).</span>
<span class="sd">        odds_1: A tensor of odds for fighter 1.</span>
<span class="sd">        odds_2: A tensor of odds for fighter 2.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tensor with the computed betting loss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">msk</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="n">targets</span>

    <span class="n">return_fighter_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">*</span> <span class="n">odds_1</span>
    <span class="n">return_fighter_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">odds_2</span>

    <span class="n">losses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_bet</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">earnings</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
    <span class="n">earnings</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">return_fighter_1</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="n">earnings</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">return_fighter_2</span><span class="p">[</span><span class="n">msk</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">losses</span> <span class="o">-</span> <span class="n">earnings</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.loss_functions.BettingLoss.get_bet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bet</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes the bet for the given prediction.</p>
<p>This function takes a prediction between 0 and 1 and returns the
corresponding bet between 0 and 20. The bet is computed as the
prediction times 2 times 10. This is just an approximation
that seems to work well.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>prediction</code>
            </td>
            <td>
                  <code>Tensor | float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor or float between 0 and 1 representing a
prediction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor | float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor or float between 0 and 20 representing the bet.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/loss_functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_bet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the bet for the given prediction.</span>

<span class="sd">    This function takes a prediction between 0 and 1 and returns the</span>
<span class="sd">    corresponding bet between 0 and 20. The bet is computed as the</span>
<span class="sd">    prediction times 2 times 10. This is just an approximation</span>
<span class="sd">    that seems to work well.</span>

<span class="sd">    Args:</span>
<span class="sd">        prediction: A tensor or float between 0 and 1 representing a</span>
<span class="sd">            prediction.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tensor or float between 0 and 20 representing the bet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">prediction</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="models">Models</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.models"></a>
    <div class="doc doc-contents first">

        <p>This module contains neural network models designed to predict the outcome of UFC 
fights.</p>
<p>The models take into account various characteristics of the fighters and the odds 
of the fights, and can be used to make predictions on the outcome of a fight and 
to calculate the benefit of a bet.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.models.FighterNet" class="doc doc-heading">
            <code>FighterNet</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>


        <p>A neural network model designed to predict the outcome of a fight based on a single
fighter's characteristics.</p>
<p>The model takes into account the characteristics of the fighter and the odds of the
fight. It can be used to make predictions on the outcome of a fight and to
calculate the benefit of a bet.</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FighterNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A neural network model designed to predict the outcome of a fight based on a single</span>
<span class="sd">    fighter&#39;s characteristics.</span>

<span class="sd">    The model takes into account the characteristics of the fighter and the odds of the</span>
<span class="sd">    fight. It can be used to make predictions on the outcome of a fight and to</span>
<span class="sd">    calculate the benefit of a bet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the FighterNet model with the given input size and dropout</span>
<span class="sd">        probability.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_size: The size of the input to the model.</span>
<span class="sd">            dropout_prob: The probability of dropout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FighterNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>

        <span class="c1"># Use the global dropout probability</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the output of the model given the input tensor x.</span>

<span class="sd">        Args:</span>
<span class="sd">            x: The input tensor to the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The output of the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the first ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the second ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the third ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc4</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the fourth ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc5</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the fifth ReLU</span>

        <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.models.FighterNet.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the FighterNet model with the given input size and dropout
probability.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_size</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the input to the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dropout_prob</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probability of dropout.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the FighterNet model with the given input size and dropout</span>
<span class="sd">    probability.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_size: The size of the input to the model.</span>
<span class="sd">        dropout_prob: The probability of dropout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FighterNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>

    <span class="c1"># Use the global dropout probability</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.models.FighterNet.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the output of the model given the input tensor x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input tensor to the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output of the model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the output of the model given the input tensor x.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: The input tensor to the model.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The output of the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the first ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the second ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the third ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc4</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the fourth ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc5</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the fifth ReLU</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.models.SymmetricFightNet" class="doc doc-heading">
            <code>SymmetricFightNet</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>


        <p>A neural network model designed to predict the outcome of a fight between two
fighters.</p>
<p>The model takes into account the characteristics of both fighters and the odds of
the fight. It uses a symmetric architecture to ensure that the model is fair and
unbiased towards either fighter.</p>
<p>The model can be used to make predictions on the outcome of a fight and to calculate
the benefit of a bet.</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SymmetricFightNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A neural network model designed to predict the outcome of a fight between two</span>
<span class="sd">    fighters.</span>

<span class="sd">    The model takes into account the characteristics of both fighters and the odds of</span>
<span class="sd">    the fight. It uses a symmetric architecture to ensure that the model is fair and</span>
<span class="sd">    unbiased towards either fighter.</span>

<span class="sd">    The model can be used to make predictions on the outcome of a fight and to calculate</span>
<span class="sd">    the benefit of a bet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the SymmetricFightNet model with the given input size and dropout</span>
<span class="sd">        probability.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_size: The size of the input to the model.</span>
<span class="sd">            dropout_prob: The probability of dropout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SymmetricFightNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fighter_net</span> <span class="o">=</span> <span class="n">FighterNet</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="n">input_size</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
        <span class="c1"># self.fc2 = nn.Linear(512, 256)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Use the global dropout probability</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">X1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">X2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">odds1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">odds2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the output of the SymmetricFightNet model.</span>

<span class="sd">        Args:</span>
<span class="sd">            X1: The input tensor for the first fighter.</span>
<span class="sd">            X2: The input tensor for the second fighter.</span>
<span class="sd">            odds1: The odds tensor for the first fighter.</span>
<span class="sd">            odds2: The odds tensor for the second fighter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The output of the SymmetricFightNet model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_net</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
        <span class="n">out2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_net</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>

        <span class="n">out1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">out1</span><span class="p">,</span> <span class="n">odds1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">out2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">out2</span><span class="p">,</span> <span class="n">odds2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">out1</span> <span class="o">-</span> <span class="n">out2</span><span class="p">,</span> <span class="n">out2</span> <span class="o">-</span> <span class="n">out1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the first ReLU</span>
        <span class="c1"># x = self.relu(self.fc2(x))</span>
        <span class="c1"># x = self.dropout2(x)  # Apply dropout after the second ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the third ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc4</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the fourth ReLU</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc5</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.models.SymmetricFightNet.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the SymmetricFightNet model with the given input size and dropout
probability.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_size</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the input to the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dropout_prob</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probability of dropout.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the SymmetricFightNet model with the given input size and dropout</span>
<span class="sd">    probability.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_size: The size of the input to the model.</span>
<span class="sd">        dropout_prob: The probability of dropout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">SymmetricFightNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fighter_net</span> <span class="o">=</span> <span class="n">FighterNet</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="n">input_size</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
    <span class="c1"># self.fc2 = nn.Linear(512, 256)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Use the global dropout probability</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">dropout_prob</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.models.SymmetricFightNet.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the output of the SymmetricFightNet model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X1</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input tensor for the first fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X2</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input tensor for the second fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds1</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The odds tensor for the first fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds2</code>
            </td>
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The odds tensor for the second fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Tensor</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output of the SymmetricFightNet model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">X2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">odds1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">odds2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the output of the SymmetricFightNet model.</span>

<span class="sd">    Args:</span>
<span class="sd">        X1: The input tensor for the first fighter.</span>
<span class="sd">        X2: The input tensor for the second fighter.</span>
<span class="sd">        odds1: The odds tensor for the first fighter.</span>
<span class="sd">        odds2: The odds tensor for the second fighter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The output of the SymmetricFightNet model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_net</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
    <span class="n">out2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fighter_net</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>

    <span class="n">out1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">out1</span><span class="p">,</span> <span class="n">odds1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">out2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">out2</span><span class="p">,</span> <span class="n">odds2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">out1</span> <span class="o">-</span> <span class="n">out2</span><span class="p">,</span> <span class="n">out2</span> <span class="o">-</span> <span class="n">out1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the first ReLU</span>
    <span class="c1"># x = self.relu(self.fc2(x))</span>
    <span class="c1"># x = self.dropout2(x)  # Apply dropout after the second ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the third ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc4</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Apply dropout after the fourth ReLU</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc5</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="trainer">Trainer</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.trainer"></a>
    <div class="doc doc-contents first">

        <p>This module provides a Trainer class for training and testing PyTorch models using a
specific workflow.</p>
<p>The Trainer class encapsulates the training and testing data, model, optimizer, loss 
function, and learning rate scheduler, providing a simple way to train and test a 
PyTorch model.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.trainer.Trainer" class="doc doc-heading">
            <code>Trainer</code>


</h2>


    <div class="doc doc-contents ">


        <p>Trainer class for training and testing a PyTorch model.</p>
<p>This class provides a simple way to train and test a PyTorch model using a specific
training and testing workflow.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.train_loader">train_loader</span></code></td>
            <td>
                  <code>DataLoader</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataLoader for the training data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.test_loader">test_loader</span></code></td>
            <td>
                  <code>DataLoader</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataLoader for the test data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.model">model</span></code></td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be trained.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.optimizer">optimizer</span></code></td>
            <td>
                  <code>Optimizer</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.loss_fn">loss_fn</span></code></td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loss function to be used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.scheduler">scheduler</span></code></td>
            <td>
                  <code>Optional[ReduceLROnPlateau]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning
rate scheduler to be used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="ufcpredictor.trainer.Trainer.device">device</span></code></td>
            <td>
                  <code>str | device</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device to be used for training. Defaults to
"cpu".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/trainer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Trainer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trainer class for training and testing a PyTorch model.</span>

<span class="sd">    This class provides a simple way to train and test a PyTorch model using a specific</span>
<span class="sd">    training and testing workflow.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        train_loader (torch.utils.data.DataLoader): A DataLoader for the training data.</span>
<span class="sd">        test_loader (torch.utils.data.DataLoader): A DataLoader for the test data.</span>
<span class="sd">        model (torch.nn.Module): The model to be trained.</span>
<span class="sd">        optimizer (torch.optim.Optimizer): The optimizer to be used.</span>
<span class="sd">        loss_fn (torch.nn.Module): The loss function to be used.</span>
<span class="sd">        scheduler (Optional[torch.optim.lr_scheduler.ReduceLROnPlateau]): The learning</span>
<span class="sd">            rate scheduler to be used.</span>
<span class="sd">        device (str | torch.device): The device to be used for training. Defaults to</span>
<span class="sd">            &quot;cpu&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">train_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">,</span>
        <span class="n">test_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
        <span class="n">loss_fn</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Trainer object.</span>

<span class="sd">        Args:</span>
<span class="sd">            train_loader: A DataLoader for the training data.</span>
<span class="sd">            test_loader: A DataLoader for the test data.</span>
<span class="sd">            model: The model to be trained.</span>
<span class="sd">            optimizer: The optimizer to be used.</span>
<span class="sd">            loss_fn: The loss function to be used.</span>
<span class="sd">            scheduler: The learning rate scheduler to be used.</span>
<span class="sd">            device: The device to be used for training. Defaults to &quot;cpu&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">train_loader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span> <span class="o">=</span> <span class="n">test_loader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">scheduler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">train_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">test_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train the model for a given number of epochs.</span>

<span class="sd">        Args:</span>
<span class="sd">            train_loader: The DataLoader for the training data. Defaults to the</span>
<span class="sd">                DataLoader passed to the Trainer constructor.</span>
<span class="sd">            test_loader: The DataLoader for the test data. Defaults to the</span>
<span class="sd">                DataLoader passed to the Trainer constructor.</span>
<span class="sd">            epochs: The number of epochs to train for. Defaults to 10.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">train_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">train_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="n">target_preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">target_labels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
            <span class="n">train_loss</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)):</span>
                <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">X1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">X2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">Y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">odds1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">odds2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
                <span class="n">target_logit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">target_logit</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>

                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

                <span class="n">train_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

                <span class="n">target_preds</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">target_logit</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">target_labels</span> <span class="o">+=</span> <span class="n">Y</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">target_preds</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
                <span class="n">target_labels</span>
            <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">val_loss</span><span class="p">,</span> <span class="n">val_target_f1</span><span class="p">,</span> <span class="n">correct</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train acc: [</span><span class="si">{</span><span class="n">match</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Epoch : [</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">] Train Loss : [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">] &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Val Loss : [</span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">] Disaster? F1 : [</span><span class="si">{</span><span class="n">val_target_f1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">] &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Correct: [</span><span class="si">{</span><span class="n">correct</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates the model on the test data and returns the validation loss, target F1</span>
<span class="sd">        score, proportion of correct predictions, target predictions, and target labels.</span>

<span class="sd">        Args:</span>
<span class="sd">            test_loader: The DataLoader for the test data. Defaults to the DataLoader</span>
<span class="sd">                passed to the Trainer constructor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple containing the validation loss, target F1 score, proportion of correct</span>
<span class="sd">            predictions, target predictions, and target labels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">test_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">test_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">val_loss</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">target_preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">target_labels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)):</span>
                <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">X1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">X2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">Y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">odds1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">odds2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">target_logit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">target_logit</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>
                <span class="n">val_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

                <span class="n">target</span> <span class="o">+=</span> <span class="n">target_logit</span>
                <span class="n">target_preds</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">target_logit</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">target_labels</span> <span class="o">+=</span> <span class="n">Y</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">target_preds</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="n">target_labels</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">target_f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">target_labels</span><span class="p">,</span> <span class="n">target_preds</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">val_loss</span><span class="p">),</span>
            <span class="n">target_f1</span><span class="p">,</span>
            <span class="k">match</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">),</span>
            <span class="n">target</span><span class="p">,</span>
            <span class="n">target_labels</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.trainer.Trainer.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the Trainer object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_loader</code>
            </td>
            <td>
                  <code>DataLoader</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataLoader for the training data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_loader</code>
            </td>
            <td>
                  <code>DataLoader</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataLoader for the test data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be trained.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code>Optimizer</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loss function to be used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scheduler</code>
            </td>
            <td>
                  <code>Optional[ReduceLROnPlateau]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate scheduler to be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code>str | device</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device to be used for training. Defaults to "cpu".</p>
              </div>
            </td>
            <td>
                  <code>&#39;cpu&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">train_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">,</span>
    <span class="n">test_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the Trainer object.</span>

<span class="sd">    Args:</span>
<span class="sd">        train_loader: A DataLoader for the training data.</span>
<span class="sd">        test_loader: A DataLoader for the test data.</span>
<span class="sd">        model: The model to be trained.</span>
<span class="sd">        optimizer: The optimizer to be used.</span>
<span class="sd">        loss_fn: The loss function to be used.</span>
<span class="sd">        scheduler: The learning rate scheduler to be used.</span>
<span class="sd">        device: The device to be used for training. Defaults to &quot;cpu&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">train_loader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span> <span class="o">=</span> <span class="n">test_loader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">scheduler</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.trainer.Trainer.test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">test</span><span class="p">(</span><span class="n">test_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluates the model on the test data and returns the validation loss, target F1
score, proportion of correct predictions, target predictions, and target labels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>test_loader</code>
            </td>
            <td>
                  <code>DataLoader | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataLoader for the test data. Defaults to the DataLoader
passed to the Trainer constructor.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the validation loss, target F1 score, proportion of correct</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>predictions, target predictions, and target labels.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">test</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates the model on the test data and returns the validation loss, target F1</span>
<span class="sd">    score, proportion of correct predictions, target predictions, and target labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        test_loader: The DataLoader for the test data. Defaults to the DataLoader</span>
<span class="sd">            passed to the Trainer constructor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing the validation loss, target F1 score, proportion of correct</span>
<span class="sd">        predictions, target predictions, and target labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">test_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">test_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">val_loss</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">target_preds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">target</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">target_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)):</span>
            <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">X1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">X2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">Y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">odds1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">odds2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">target_logit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">target_logit</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>
            <span class="n">val_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

            <span class="n">target</span> <span class="o">+=</span> <span class="n">target_logit</span>
            <span class="n">target_preds</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">target_logit</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">target_labels</span> <span class="o">+=</span> <span class="n">Y</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">target_preds</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
        <span class="n">target_labels</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">target_f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">target_labels</span><span class="p">,</span> <span class="n">target_preds</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">val_loss</span><span class="p">),</span>
        <span class="n">target_f1</span><span class="p">,</span>
        <span class="k">match</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">),</span>
        <span class="n">target</span><span class="p">,</span>
        <span class="n">target_labels</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.trainer.Trainer.train" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">train</span><span class="p">(</span><span class="n">train_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Train the model for a given number of epochs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_loader</code>
            </td>
            <td>
                  <code>DataLoader | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataLoader for the training data. Defaults to the
DataLoader passed to the Trainer constructor.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_loader</code>
            </td>
            <td>
                  <code>DataLoader | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataLoader for the test data. Defaults to the
DataLoader passed to the Trainer constructor.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epochs</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of epochs to train for. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">train</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">train_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">test_loader</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Train the model for a given number of epochs.</span>

<span class="sd">    Args:</span>
<span class="sd">        train_loader: The DataLoader for the training data. Defaults to the</span>
<span class="sd">            DataLoader passed to the Trainer constructor.</span>
<span class="sd">        test_loader: The DataLoader for the test data. Defaults to the</span>
<span class="sd">            DataLoader passed to the Trainer constructor.</span>
<span class="sd">        epochs: The number of epochs to train for. Defaults to 10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">train_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">train_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="n">target_preds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">target_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">train_loss</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)):</span>
            <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">X1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">X2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">Y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">odds1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="n">odds2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">target_logit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">target_logit</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">)</span>

            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">train_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

            <span class="n">target_preds</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">target_logit</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">target_labels</span> <span class="o">+=</span> <span class="n">Y</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">target_preds</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="n">target_labels</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">val_loss</span><span class="p">,</span> <span class="n">val_target_f1</span><span class="p">,</span> <span class="n">correct</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train acc: [</span><span class="si">{</span><span class="n">match</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Epoch : [</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">] Train Loss : [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">] &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Val Loss : [</span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">] Disaster? F1 : [</span><span class="si">{</span><span class="n">val_target_f1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">] &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Correct: [</span><span class="si">{</span><span class="n">correct</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="plot-tools">Plot tools</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.plot_tools"></a>
    <div class="doc doc-contents first">

        <p>This module provides tools for plotting and visualizing predictions made by UFC
predictor models.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ufcpredictor.plot_tools.PredictionPlots" class="doc doc-heading">
            <code>PredictionPlots</code>


</h2>


    <div class="doc doc-contents ">


        <p>Provides tools for visualizing and analyzing the predictions made by UFC predictor
models.</p>
<p>This class contains methods for displaying the prediction details of a fight,
including the prediction, shift, odds, and correctness. It also calculates and
displays the total invested, earnings, number of bets, and number of fights.
Additionally, it can show a plot of the benefit of the model over time.</p>






              <details class="quote">
                <summary>Source code in <code>ufcpredictor/plot_tools.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PredictionPlots</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides tools for visualizing and analyzing the predictions made by UFC predictor</span>
<span class="sd">    models.</span>

<span class="sd">    This class contains methods for displaying the prediction details of a fight,</span>
<span class="sd">    including the prediction, shift, odds, and correctness. It also calculates and</span>
<span class="sd">    displays the total invested, earnings, number of bets, and number of fights.</span>
<span class="sd">    Additionally, it can show a plot of the benefit of the model over time.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">show_fight_prediction_detail</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
            <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
            <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="n">print_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">show_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the prediction detail of a fight and the benefit of the model.</span>

<span class="sd">        It prints the prediction, shift, odd1, odd2, and correct for each fight.</span>
<span class="sd">        It also prints the total invested, earnings, number of bets and number</span>
<span class="sd">            of fights.</span>
<span class="sd">        Finally, it prints the benefit of the model as a percentage.</span>

<span class="sd">        Args:</span>
<span class="sd">            model : The model to use to make predictions.</span>
<span class="sd">            data : The data to use to make predictions. It should contain the fighter</span>
<span class="sd">                and opponent data, the label, the odds and the names of the fighters.</span>
<span class="sd">            print_info : If True, print the prediction, shift, odd1, odd2, and correct</span>
<span class="sd">                for each fight. If False, do not print anything.</span>
<span class="sd">            show_plot : If True, show a plot of the benefit of the model over time.</span>
<span class="sd">            ax : The axes to use to show the plot. If None, a new figure will be</span>
<span class="sd">                created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">predictions_1</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">odds2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="o">.</span><span class="n">detach</span><span class="p">()</span>
                <span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
                <span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
                <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">predictions_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span>
                <span class="n">X2</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">odds2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">odds1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">predictions</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">predictions_1</span> <span class="o">+</span> <span class="n">predictions_2</span><span class="p">)</span>
            <span class="n">shifts</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictions_2</span> <span class="o">-</span> <span class="n">predictions_1</span><span class="p">)</span>

            <span class="n">corrects</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">round</span><span class="p">()</span> <span class="o">==</span> <span class="n">Y</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

            <span class="n">odds1</span> <span class="o">=</span> <span class="n">odds1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">odds2</span> <span class="o">=</span> <span class="n">odds2</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">invested</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">earnings</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">fights</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nbets</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">invest_progress</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">earning_progress</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">fighter</span><span class="p">,</span> <span class="n">opponent</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">odd1</span><span class="p">,</span> <span class="n">odd2</span><span class="p">,</span> <span class="n">correct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">fighter_names</span><span class="p">,</span>
                <span class="n">opponent_names</span><span class="p">,</span>
                <span class="n">predictions</span><span class="p">,</span>
                <span class="n">shifts</span><span class="p">,</span>
                <span class="n">odds1</span><span class="p">,</span>
                <span class="n">odds2</span><span class="p">,</span>
                <span class="n">corrects</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">prediction</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
                <span class="n">shift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">shift</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                    <span class="n">bet</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">prediction</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
                    <span class="n">earning</span> <span class="o">=</span> <span class="n">odd2</span> <span class="o">*</span> <span class="n">bet</span> <span class="k">if</span> <span class="n">correct</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bet</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">prediction</span><span class="p">)</span>
                    <span class="n">earning</span> <span class="o">=</span> <span class="n">odd1</span> <span class="o">*</span> <span class="n">bet</span> <span class="k">if</span> <span class="n">correct</span> <span class="k">else</span> <span class="mi">0</span>

                <span class="n">invested</span> <span class="o">+=</span> <span class="n">bet</span>
                <span class="n">earnings</span> <span class="o">+=</span> <span class="n">earning</span>

                <span class="n">invest_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>
                <span class="n">earning_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">earning</span><span class="p">)</span>

                <span class="n">fights</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">nbets</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">print_info</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">fighter</span><span class="p">,</span> <span class="s2">&quot;vs&quot;</span><span class="p">,</span> <span class="n">opponent</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">odd1</span><span class="p">,</span> <span class="s2">&quot;vs&quot;</span><span class="p">,</span> <span class="n">odd2</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bet: </span><span class="si">{</span><span class="n">bet</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, earn: </span><span class="si">{</span><span class="n">earning</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;invested: </span><span class="si">{</span><span class="n">invested</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, earnings: </span><span class="si">{</span><span class="n">earnings</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, nbets: </span><span class="si">{</span><span class="n">nbets</span><span class="si">}</span><span class="s2">, fights: </span><span class="si">{</span><span class="n">fights</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;benefits: </span><span class="si">{</span><span class="p">(</span><span class="n">earnings</span><span class="o">/</span><span class="n">invested</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

                    <span class="nb">print</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">show_plot</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">invest_progress</span><span class="p">),</span>
                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">earning_progress</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">invest_progress</span><span class="p">))</span>
                <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">invest_progress</span><span class="p">)</span>
                <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">show_fight_prediction_detail_from_dataset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="n">BasicDataset</span><span class="p">,</span>
        <span class="n">fight_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">print_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">show_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the prediction detail of a fight and the benefit of the model.</span>

<span class="sd">        It uses the dataset to get the data for the specified fight ids.</span>
<span class="sd">        It then calls show_fight_prediction_detail with the model and the data.</span>

<span class="sd">        Args:</span>
<span class="sd">            model : The model to use to make predictions.</span>
<span class="sd">            dataset : The dataset to use to get the data.</span>
<span class="sd">            fight_ids : The id of the fight to use. If None, it will use all the data</span>
<span class="sd">                in the dataset.</span>
<span class="sd">            print_info : If True, print the prediction, shift, odd1, odd2, and correct</span>
<span class="sd">                for each fight. If False, do not print anything.</span>
<span class="sd">            show_plot : If True, show a plot of the benefit of the model over time.</span>
<span class="sd">            ax : The axes to use to show the plot. If None, a new figure will be</span>
<span class="sd">                created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">get_fight_data_from_ids</span><span class="p">(</span><span class="n">fight_ids</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">PredictionPlots</span><span class="o">.</span><span class="n">show_fight_prediction_detail</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span><span class="p">),</span>
            <span class="n">print_info</span><span class="p">,</span>
            <span class="n">show_plot</span><span class="p">,</span>
            <span class="n">ax</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">plot_single_prediction</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="n">BasicDataset</span><span class="p">,</span>
        <span class="n">fighter_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">opponent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">event_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
        <span class="n">odds1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">odds2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the prediction for a single fight.</span>

<span class="sd">        Args:</span>
<span class="sd">            model : The model to use to make predictions.</span>
<span class="sd">            dataset : The dataset to use to get the data.</span>
<span class="sd">            fighter_name : The name of the first fighter.</span>
<span class="sd">            opponent_name : The name of the second fighter.</span>
<span class="sd">            event_date : The date of the fight.</span>
<span class="sd">            odds1 : The odds for the first fighter (decimal).</span>
<span class="sd">            odds2 : The odds for the second fighter (decimal).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_single_forecast_prediction</span><span class="p">(</span>
            <span class="n">fighter_name</span><span class="p">,</span> <span class="n">opponent_name</span><span class="p">,</span> <span class="n">event_date</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">model</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">prediction</span> <span class="o">=</span> <span class="p">((</span><span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">*</span><span class="mi">100</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span>

        <span class="n">red</span> <span class="o">=</span> <span class="s2">&quot;tab:red&quot;</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="s2">&quot;tab:blue&quot;</span>

        <span class="n">color</span> <span class="o">=</span> <span class="n">red</span> <span class="k">if</span> <span class="n">prediction</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">blue</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">prediction</span><span class="p">,</span>
            <span class="n">xerr</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>

        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">tick</span><span class="p">)</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.3</span><span class="p">,</span>
            <span class="n">fighter_name</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">red</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.3</span><span class="p">,</span>
            <span class="n">opponent_name</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">prediction</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"></span><span class="si">{</span><span class="n">shift</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.plot_tools.PredictionPlots.plot_single_prediction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_single_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">fighter_name</span><span class="p">,</span> <span class="n">opponent_name</span><span class="p">,</span> <span class="n">event_date</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Plots the prediction for a single fight.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to use to make predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset to use to get the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fighter_name</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the first fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opponent_name</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the second fighter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_date</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The date of the fight.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds1</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The odds for the first fighter (decimal).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>odds2</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The odds for the second fighter (decimal).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/plot_tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">plot_single_prediction</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">BasicDataset</span><span class="p">,</span>
    <span class="n">fighter_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">opponent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">event_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
    <span class="n">odds1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">odds2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the prediction for a single fight.</span>

<span class="sd">    Args:</span>
<span class="sd">        model : The model to use to make predictions.</span>
<span class="sd">        dataset : The dataset to use to get the data.</span>
<span class="sd">        fighter_name : The name of the first fighter.</span>
<span class="sd">        opponent_name : The name of the second fighter.</span>
<span class="sd">        event_date : The date of the fight.</span>
<span class="sd">        odds1 : The odds for the first fighter (decimal).</span>
<span class="sd">        odds2 : The odds for the second fighter (decimal).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_single_forecast_prediction</span><span class="p">(</span>
        <span class="n">fighter_name</span><span class="p">,</span> <span class="n">opponent_name</span><span class="p">,</span> <span class="n">event_date</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">model</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="n">prediction</span> <span class="o">=</span> <span class="p">((</span><span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">*</span><span class="mi">100</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span>

    <span class="n">red</span> <span class="o">=</span> <span class="s2">&quot;tab:red&quot;</span>
    <span class="n">blue</span> <span class="o">=</span> <span class="s2">&quot;tab:blue&quot;</span>

    <span class="n">color</span> <span class="o">=</span> <span class="n">red</span> <span class="k">if</span> <span class="n">prediction</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">blue</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">prediction</span><span class="p">,</span>
        <span class="n">xerr</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>

    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

    <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">tick</span><span class="p">)</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.3</span><span class="p">,</span>
        <span class="n">fighter_name</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">red</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.3</span><span class="p">,</span>
        <span class="n">opponent_name</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">prediction</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"></span><span class="si">{</span><span class="n">shift</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.plot_tools.PredictionPlots.show_fight_prediction_detail" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_fight_prediction_detail</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">print_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Shows the prediction detail of a fight and the benefit of the model.</p>
<p>It prints the prediction, shift, odd1, odd2, and correct for each fight.
It also prints the total invested, earnings, number of bets and number
    of fights.
Finally, it prints the benefit of the model as a percentage.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to use to make predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to use to make predictions. It should contain the fighter
and opponent data, the label, the odds and the names of the fighters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_info</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print the prediction, shift, odd1, odd2, and correct
for each fight. If False, do not print anything.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_plot</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, show a plot of the benefit of the model over time.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The axes to use to show the plot. If None, a new figure will be
created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/plot_tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">show_fight_prediction_detail</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">print_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the prediction detail of a fight and the benefit of the model.</span>

<span class="sd">    It prints the prediction, shift, odd1, odd2, and correct for each fight.</span>
<span class="sd">    It also prints the total invested, earnings, number of bets and number</span>
<span class="sd">        of fights.</span>
<span class="sd">    Finally, it prints the benefit of the model as a percentage.</span>

<span class="sd">    Args:</span>
<span class="sd">        model : The model to use to make predictions.</span>
<span class="sd">        data : The data to use to make predictions. It should contain the fighter</span>
<span class="sd">            and opponent data, the label, the odds and the names of the fighters.</span>
<span class="sd">        print_info : If True, print the prediction, shift, odd1, odd2, and correct</span>
<span class="sd">            for each fight. If False, do not print anything.</span>
<span class="sd">        show_plot : If True, show a plot of the benefit of the model over time.</span>
<span class="sd">        ax : The axes to use to show the plot. If None, a new figure will be</span>
<span class="sd">            created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">predictions_1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">model</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">odds1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">odds2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">detach</span><span class="p">()</span>
            <span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
            <span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">predictions_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span>
            <span class="n">X2</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">odds2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">odds1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">predictions_1</span> <span class="o">+</span> <span class="n">predictions_2</span><span class="p">)</span>
        <span class="n">shifts</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictions_2</span> <span class="o">-</span> <span class="n">predictions_1</span><span class="p">)</span>

        <span class="n">corrects</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">round</span><span class="p">()</span> <span class="o">==</span> <span class="n">Y</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

        <span class="n">odds1</span> <span class="o">=</span> <span class="n">odds1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">odds2</span> <span class="o">=</span> <span class="n">odds2</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">invested</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">earnings</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fights</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nbets</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">invest_progress</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">earning_progress</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">fighter</span><span class="p">,</span> <span class="n">opponent</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">odd1</span><span class="p">,</span> <span class="n">odd2</span><span class="p">,</span> <span class="n">correct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">fighter_names</span><span class="p">,</span>
            <span class="n">opponent_names</span><span class="p">,</span>
            <span class="n">predictions</span><span class="p">,</span>
            <span class="n">shifts</span><span class="p">,</span>
            <span class="n">odds1</span><span class="p">,</span>
            <span class="n">odds2</span><span class="p">,</span>
            <span class="n">corrects</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">shift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">shift</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="n">bet</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">prediction</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
                <span class="n">earning</span> <span class="o">=</span> <span class="n">odd2</span> <span class="o">*</span> <span class="n">bet</span> <span class="k">if</span> <span class="n">correct</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bet</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">prediction</span><span class="p">)</span>
                <span class="n">earning</span> <span class="o">=</span> <span class="n">odd1</span> <span class="o">*</span> <span class="n">bet</span> <span class="k">if</span> <span class="n">correct</span> <span class="k">else</span> <span class="mi">0</span>

            <span class="n">invested</span> <span class="o">+=</span> <span class="n">bet</span>
            <span class="n">earnings</span> <span class="o">+=</span> <span class="n">earning</span>

            <span class="n">invest_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>
            <span class="n">earning_progress</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">earning</span><span class="p">)</span>

            <span class="n">fights</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nbets</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">print_info</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">fighter</span><span class="p">,</span> <span class="s2">&quot;vs&quot;</span><span class="p">,</span> <span class="n">opponent</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">odd1</span><span class="p">,</span> <span class="s2">&quot;vs&quot;</span><span class="p">,</span> <span class="n">odd2</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bet: </span><span class="si">{</span><span class="n">bet</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, earn: </span><span class="si">{</span><span class="n">earning</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invested: </span><span class="si">{</span><span class="n">invested</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, earnings: </span><span class="si">{</span><span class="n">earnings</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, nbets: </span><span class="si">{</span><span class="n">nbets</span><span class="si">}</span><span class="s2">, fights: </span><span class="si">{</span><span class="n">fights</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;benefits: </span><span class="si">{</span><span class="p">(</span><span class="n">earnings</span><span class="o">/</span><span class="n">invested</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">show_plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">invest_progress</span><span class="p">),</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">earning_progress</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">invest_progress</span><span class="p">))</span>
            <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">invest_progress</span><span class="p">)</span>
            <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ufcpredictor.plot_tools.PredictionPlots.show_fight_prediction_detail_from_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_fight_prediction_detail_from_dataset</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">fight_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Shows the prediction detail of a fight and the benefit of the model.</p>
<p>It uses the dataset to get the data for the specified fight ids.
It then calls show_fight_prediction_detail with the model and the data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to use to make predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset to use to get the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fight_ids</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The id of the fight to use. If None, it will use all the data
in the dataset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_info</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print the prediction, shift, odd1, odd2, and correct
for each fight. If False, do not print anything.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_plot</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, show a plot of the benefit of the model over time.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The axes to use to show the plot. If None, a new figure will be
created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/plot_tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">show_fight_prediction_detail_from_dataset</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">BasicDataset</span><span class="p">,</span>
    <span class="n">fight_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">print_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the prediction detail of a fight and the benefit of the model.</span>

<span class="sd">    It uses the dataset to get the data for the specified fight ids.</span>
<span class="sd">    It then calls show_fight_prediction_detail with the model and the data.</span>

<span class="sd">    Args:</span>
<span class="sd">        model : The model to use to make predictions.</span>
<span class="sd">        dataset : The dataset to use to get the data.</span>
<span class="sd">        fight_ids : The id of the fight to use. If None, it will use all the data</span>
<span class="sd">            in the dataset.</span>
<span class="sd">        print_info : If True, print the prediction, shift, odd1, odd2, and correct</span>
<span class="sd">            for each fight. If False, do not print anything.</span>
<span class="sd">        show_plot : If True, show a plot of the benefit of the model over time.</span>
<span class="sd">        ax : The axes to use to show the plot. If None, a new figure will be</span>
<span class="sd">            created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">get_fight_data_from_ids</span><span class="p">(</span><span class="n">fight_ids</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">PredictionPlots</span><span class="o">.</span><span class="n">show_fight_prediction_detail</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">odds1</span><span class="p">,</span> <span class="n">odds2</span><span class="p">,</span> <span class="n">fighter_names</span><span class="p">,</span> <span class="n">opponent_names</span><span class="p">),</span>
        <span class="n">print_info</span><span class="p">,</span>
        <span class="n">show_plot</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="utils">Utils</h2>


<div class="doc doc-object doc-module">



<a id="ufcpredictor.utils"></a>
    <div class="doc doc-contents first">

        <p>Utility functions for the UFC predictor project.</p>
<p>This module contains various utility functions used throughout the project, including
functions for converting between different time and odds formats, as well as other
miscellaneous helper functions.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="ufcpredictor.utils.convert_minutes_to_seconds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_minutes_to_seconds</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert a time string from minutes:seconds format to seconds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>time_str</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time string in minutes:seconds format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Optional[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time in seconds. If the input string is "--", returns 0. If the input is None
or "NULL", or if the input is NaN, returns None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_minutes_to_seconds</span><span class="p">(</span><span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a time string from minutes:seconds format to seconds.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_str: Time string in minutes:seconds format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Time in seconds. If the input string is &quot;--&quot;, returns 0. If the input is None</span>
<span class="sd">            or &quot;NULL&quot;, or if the input is NaN, returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">time_str</span> <span class="o">==</span> <span class="s2">&quot;--&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">time_str</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">time_str</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">time_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">minutes</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">seconds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ufcpredictor.utils.convert_odds_to_decimal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_odds_to_decimal</span><span class="p">(</span><span class="n">odds</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert odds from American format to decimal format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>odds</code>
            </td>
            <td>
                  <code>List[int | float] | NDArray[float64 | int_]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Odds in American format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NDArray[float64]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Odds in decimal format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_odds_to_decimal</span><span class="p">(</span><span class="n">odds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert odds from American format to decimal format.</span>

<span class="sd">    Args:</span>
<span class="sd">        odds: Odds in American format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Odds in decimal format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">odds</span> <span class="o">=</span> <span class="n">odds</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">msk</span> <span class="o">=</span> <span class="n">odds</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="n">odds</span><span class="p">[</span><span class="n">msk</span><span class="p">]</span> <span class="o">=</span> <span class="n">odds</span><span class="p">[</span><span class="n">msk</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">odds</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="o">-</span><span class="n">odds</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">odds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ufcpredictor.utils.convert_odds_to_moneyline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_odds_to_moneyline</span><span class="p">(</span><span class="n">odds</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert odds from decimal format to moneyline format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>odds</code>
            </td>
            <td>
                  <code>NDArray[float64] | List[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Odds in decimal format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NDArray[int_]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Odds in moneyline format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>ufcpredictor/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_odds_to_moneyline</span><span class="p">(</span><span class="n">odds</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert odds from decimal format to moneyline format.</span>

<span class="sd">    Args:</span>
<span class="sd">        odds: Odds in decimal format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Odds in moneyline format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">msk</span> <span class="o">=</span> <span class="n">odds</span> <span class="o">&gt;</span> <span class="mi">2</span>

    <span class="n">odds</span><span class="p">[</span><span class="n">msk</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">odds</span><span class="p">[</span><span class="n">msk</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">odds</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">odds</span><span class="p">[</span><span class="o">~</span><span class="n">msk</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">odds</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>